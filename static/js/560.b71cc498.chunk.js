/*! For license information please see 560.b71cc498.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkwebsiteportfolio=self.webpackChunkwebsiteportfolio||[]).push([[560],{52:(t,e,n)=>{n.d(e,{KO:()=>$,MF:()=>X,Sx:()=>Y,Wp:()=>J,j6:()=>K,om:()=>z,xZ:()=>H});var r=n(8812),i=n(443),s=n(1529),o=n(2799);class a{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){const e=t.getImmediate();return"".concat(e.library,"/").concat(e.version)}return null}).filter(t=>t).join(" ")}}const c="@firebase/app",l="0.13.2",u=new i.Vy("@firebase/app"),h="@firebase/app-compat",d="@firebase/analytics-compat",f="@firebase/analytics",p="@firebase/app-check-compat",g="@firebase/app-check",m="@firebase/auth",y="@firebase/auth-compat",v="@firebase/database",w="@firebase/data-connect",b="@firebase/database-compat",E="@firebase/functions",T="@firebase/functions-compat",_="@firebase/installations",C="@firebase/installations-compat",S="@firebase/messaging",A="@firebase/messaging-compat",I="@firebase/performance",D="@firebase/performance-compat",k="@firebase/remote-config",N="@firebase/remote-config-compat",x="@firebase/storage",R="@firebase/storage-compat",O="@firebase/firestore",P="@firebase/ai",L="@firebase/firestore-compat",M="firebase",F="[DEFAULT]",V={[c]:"fire-core",[h]:"fire-core-compat",[f]:"fire-analytics",[d]:"fire-analytics-compat",[g]:"fire-app-check",[p]:"fire-app-check-compat",[m]:"fire-auth",[y]:"fire-auth-compat",[v]:"fire-rtdb",[w]:"fire-data-connect",[b]:"fire-rtdb-compat",[E]:"fire-fn",[T]:"fire-fn-compat",[_]:"fire-iid",[C]:"fire-iid-compat",[S]:"fire-fcm",[A]:"fire-fcm-compat",[I]:"fire-perf",[D]:"fire-perf-compat",[k]:"fire-rc",[N]:"fire-rc-compat",[x]:"fire-gcs",[R]:"fire-gcs-compat",[O]:"fire-fst",[L]:"fire-fst-compat",[P]:"fire-vertex","fire-js":"fire-js",[M]:"fire-js-all"},U=new Map,j=new Map,B=new Map;function q(t,e){try{t.container.addComponent(e)}catch(n){u.debug("Component ".concat(e.name," failed to register with FirebaseApp ").concat(t.name),n)}}function z(t){const e=t.name;if(B.has(e))return u.debug("There were multiple attempts to register component ".concat(e,".")),!1;B.set(e,t);for(const n of U.values())q(n,t);for(const n of j.values())q(n,t);return!0}function K(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function H(t){return null!==t&&void 0!==t&&void 0!==t.settings}const G={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},W=new s.FA("app","Firebase",G);class Q{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw W.create("app-deleted",{appName:this._name})}}const X="11.10.0";function J(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t;if("object"!==typeof e){e={name:e}}const i=Object.assign({name:F,automaticDataCollectionEnabled:!0},e),o=i.name;if("string"!==typeof o||!o)throw W.create("bad-app-name",{appName:String(o)});if(n||(n=(0,s.T9)()),!n)throw W.create("no-options");const a=U.get(o);if(a){if((0,s.bD)(n,a.options)&&(0,s.bD)(i,a.config))return a;throw W.create("duplicate-app",{appName:o})}const c=new r.h1(o);for(const r of B.values())c.addComponent(r);const l=new Q(n,i,c);return U.set(o,l),l}function Y(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F;const e=U.get(t);if(!e&&t===F&&(0,s.T9)())return J();if(!e)throw W.create("no-app",{appName:t});return e}function $(t,e,n){var i;let s=null!==(i=V[t])&&void 0!==i?i:t;n&&(s+="-".concat(n));const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=['Unable to register library "'.concat(s,'" with version "').concat(e,'":')];return o&&t.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),o&&a&&t.push("and"),a&&t.push('version name "'.concat(e,'" contains illegal characters (whitespace or "/")')),void u.warn(t.join(" "))}z(new r.uA("".concat(s,"-version"),()=>({library:s,version:e}),"VERSION"))}const Z="firebase-heartbeat-store";let tt=null;function et(){return tt||(tt=(0,o.P2)("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(Z)}catch(n){console.warn(n)}}}).catch(t=>{throw W.create("idb-open",{originalErrorMessage:t.message})})),tt}async function nt(t,e){try{const n=(await et()).transaction(Z,"readwrite"),r=n.objectStore(Z);await r.put(e,rt(t)),await n.done}catch(n){if(n instanceof s.g)u.warn(n.message);else{const t=W.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});u.warn(t.message)}}}function rt(t){return"".concat(t.name,"!").concat(t.options.appId)}class it{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new ot(e),this._heartbeatsCachePromise=this._storage.read().then(t=>(this._heartbeatsCache=t,t))}async triggerHeartbeat(){var t,e;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=st();if(null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(t=>t.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const t=function(t){if(0===t.length)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(t,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){u.warn(n)}}async getHeartbeatsHeader(){var t;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=st(),{heartbeatsToSend:n,unsentEntries:r}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=t.slice();for(const i of t){const t=n.find(t=>t.agent===i.agent);if(t){if(t.dates.push(i.date),at(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),at(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=(0,s.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return u.warn(e),""}}}function st(){return(new Date).toISOString().substring(0,10)}class ot{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.zW)()&&(0,s.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await et()).transaction(Z),n=await e.objectStore(Z).get(rt(t));return await e.done,n}catch(e){if(e instanceof s.g)u.warn(e.message);else{const t=W.create("idb-get",{originalErrorMessage:null===e||void 0===e?void 0:e.message});u.warn(t.message)}}}(this.app);return(null===t||void 0===t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return nt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return nt(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function at(t){return(0,s.Uj)(JSON.stringify({version:2,heartbeats:t})).length}var ct;ct="",z(new r.uA("platform-logger",t=>new a(t),"PRIVATE")),z(new r.uA("heartbeat",t=>new it(t),"PRIVATE")),$(c,l,ct),$(c,l,"esm2017"),$("fire-js","")},443:(t,e,n)=>{n.d(e,{$b:()=>i,Vy:()=>l});const r=[];var i;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(i={}));const s={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},o=i.INFO,a={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},c=function(t,e){if(e<t.logLevel)return;const n=(new Date).toISOString(),r=a[e];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(e,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(t.name,":"),...s)};class l{constructor(t){this.name=t,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in i))throw new TypeError('Invalid value "'.concat(t,'" assigned to `logLevel`'));this._logLevel=t}setLogLevel(t){this._logLevel="string"===typeof t?s[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}},1529:(t,e,n)=>{n.d(e,{cY:()=>d,FA:()=>D,g:()=>I,dM:()=>A,u:()=>a,Uj:()=>o,p9:()=>M,Fy:()=>g,bD:()=>N,T9:()=>h,yU:()=>u,mS:()=>c,Ku:()=>F,ZQ:()=>w,sr:()=>E,zJ:()=>f,zW:()=>C,nr:()=>T,Ov:()=>_,gE:()=>p,P1:()=>v,eX:()=>S});const r=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296===(64512&i)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const e=t[i],s=i+1<t.length,o=s?t[i+1]:0,a=i+2<t.length,c=a?t[i+2]:0,l=e>>2,u=(3&e)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(r(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const e=n[t.charAt(i++)],o=i<t.length?n[t.charAt(i)]:0;++i;const a=i<t.length?n[t.charAt(i)]:64;++i;const c=i<t.length?n[t.charAt(i)]:64;if(++i,null==e||null==o||null==a||null==c)throw new s;const l=e<<2|o>>4;if(r.push(l),64!==a){const t=o<<4&240|a>>2;if(r.push(t),64!==c){const t=a<<6&192|c;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(t){return function(t){const e=r(t);return i.encodeByteArray(e,!0)}(t).replace(/\./g,"")},a=function(t){try{return i.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function c(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const l=()=>{try{return c().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const t={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_KEY:"AIzaSyDwXupBnqQilD5LZWmghrbjZ7zfQk8IxNY",REACT_APP__AUTH_DOMAIN:"portfolio-data-e27a8.firebaseapp.com",REACT_APP_PROJECT_ID:"portfolio-data-e27a8",REACT_APP_PROJECT_ID_STORAGE_BUCKET:"portfolio-data-e27a8.firebasestorage.app",REACT_APP_MESSAGE_SENDER_ID:"687767332918",REACT_APP_APP_ID:"1:687767332918:web:e908e667ac14446b385097",REACT_APP_MEASUREMENT_ID:"G-0F11D4C5XT"}.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"===typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const e=t&&a(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(t))}},u=t=>{const e=(t=>{var e,n;return null===(n=null===(e=l())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error("Invalid host ".concat(e," with no separate hostname and port!"));const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]},h=()=>{var t;return null===(t=l())||void 0===t?void 0:t.config};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"===typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,n))}}}function f(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch(e){return!1}}async function p(t){return(await fetch(t,{credentials:"include"})).ok}function g(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(s)),""].join(".")}const m={};let y=!1;function v(t,e){if("undefined"===typeof window||"undefined"===typeof document||!f(window.location.host)||m[t]===e||m[t]||y)return;function n(t){return"__firebase__banner__".concat(t)}m[t]=e;const r="__firebase__banner",i=function(){const t={prod:[],emulator:[]};for(const e of Object.keys(m))m[e]?t.emulator.push(e):t.prod.push(e);return t}().prod.length>0;function s(){const t=document.createElement("span");return t.style.cursor="pointer",t.style.marginLeft="16px",t.style.fontSize="24px",t.innerHTML=" &times;",t.onclick=()=>{y=!0,function(){const t=document.getElementById(r);t&&t.remove()}()},t}function o(){const t=function(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}(r),e=n("text"),o=document.getElementById(e)||document.createElement("span"),a=n("learnmore"),c=document.getElementById(a)||document.createElement("a"),l=n("preprendIcon"),u=document.getElementById(l)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(t.created){const e=t.element;!function(t){t.style.display="flex",t.style.background="#7faaf0",t.style.position="fixed",t.style.bottom="5px",t.style.left="5px",t.style.padding=".5em",t.style.borderRadius="5px",t.style.alignItems="center"}(e),function(t,e){t.setAttribute("id",e),t.innerText="Learn more",t.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",t.setAttribute("target","__blank"),t.style.paddingLeft="5px",t.style.textDecoration="underline"}(c,a);const n=s();!function(t,e){t.setAttribute("width","24"),t.setAttribute("id",e),t.setAttribute("height","24"),t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.style.marginLeft="-6px"}(u,l),e.append(u,o,c,n),document.body.appendChild(e)}i?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",e)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function w(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function b(){var t;const e=null===(t=l())||void 0===t?void 0:t.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function E(){const t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}function T(){return!b()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){return!b()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function C(){try{return"object"===typeof indexedDB}catch(t){return!1}}function S(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(n){e(n)}})}function A(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}class I extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,I.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,D.prototype.create)}}class D{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t){const e=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(t),r=this.errors[t],i=r?function(t,e){return t.replace(k,(t,n)=>{const r=e[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,e):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new I(n,s,e)}}const k=/\{\$([^}]+)}/g;function N(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],s=e[i];if(x(n)&&x(s)){if(!N(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function x(t){return null!==t&&"object"===typeof t}const R=1e3,O=2,P=144e5,L=.5;function M(t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O;const n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:R)*Math.pow(e,t),r=Math.round(L*n*(Math.random()-.5)*2);return Math.min(P,n+r)}function F(t){return t&&t._delegate?t._delegate:t}},2487:(t,e,n)=>{n.d(e,{A:()=>r});const r=n(5043).createContext(void 0)},2799:(t,e,n)=>{n.d(e,{P2:()=>y});var r=n(9379);const i=(t,e)=>e.some(e=>t instanceof e);let s,o;const a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,h=new WeakMap;let d={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return c.get(t);if("objectStoreNames"===e)return t.objectStoreNames||l.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return g(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function f(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(m(this),n),g(a.get(this))}:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return g(t.apply(m(this),n))}:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=t.call(m(this),e,...r);return l.set(s,e.sort?e.sort():[e]),g(s)}}function p(t){return"function"===typeof t?f(t):(t instanceof IDBTransaction&&function(t){if(c.has(t))return;const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),r()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)});c.set(t,e)}(t),i(t,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,d):t)}function g(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(g(t.result)),r()},s=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",s)});return e.then(e=>{e instanceof IDBCursor&&a.set(e,t)}).catch(()=>{}),h.set(e,t),e}(t);if(u.has(t))return u.get(t);const e=p(t);return e!==t&&(u.set(t,e),h.set(e,t)),e}const m=t=>h.get(t);function y(t,e){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(t,e),a=g(o);return r&&o.addEventListener("upgradeneeded",t=>{r(g(o.result),t.oldVersion,t.newVersion,g(o.transaction),t)}),n&&o.addEventListener("blocked",t=>n(t.oldVersion,t.newVersion,t)),a.then(t=>{s&&t.addEventListener("close",()=>s()),i&&t.addEventListener("versionchange",t=>i(t.oldVersion,t.newVersion,t))}).catch(()=>{}),a}const v=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],b=new Map;function E(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!==typeof e)return;if(b.get(e))return b.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=w.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!v.includes(n))return;const s=async function(t){const e=this.transaction(t,i?"readwrite":"readonly");let s=e.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&e.done]))[0]};return b.set(e,s),s}d=(t=>(0,r.A)((0,r.A)({},t),{},{get:(e,n,r)=>E(e,n)||t.get(e,n,r),has:(e,n)=>!!E(e,n)||t.has(e,n)}))(d)},4605:(t,e,n)=>{n.d(e,{A:()=>C});var r=n(9379),i=n(45),s=n(5043),o=n(8387),a=n(8610),c=n(5213),l=n(4535),u=n(2094),h=n(8206),d=n(4496),f=n(6803),p=n(2532),g=n(2372);function m(t){return(0,g.Ay)("MuiFormControlLabel",t)}const y=(0,p.A)("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]);var v=n(4827),w=n(4162),b=n(579);const E=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slots","slotProps","value"],T=(0,l.Ay)("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{["& .".concat(y.label)]:e.label},e.root,e["labelPlacement".concat((0,f.A)(n.labelPlacement))]]}})((0,u.A)(t=>{let{theme:e}=t;return{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,["&.".concat(y.disabled)]:{cursor:"default"},["& .".concat(y.label)]:{["&.".concat(y.disabled)]:{color:(e.vars||e).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:t=>{let{labelPlacement:e}=t;return"start"===e||"top"===e||"bottom"===e},style:{marginLeft:16}}]}})),_=(0,l.Ay)("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})((0,u.A)(t=>{let{theme:e}=t;return{["&.".concat(y.error)]:{color:(e.vars||e).palette.error.main}}})),C=s.forwardRef(function(t,e){var n;const l=(0,h.b)({props:t,name:"MuiFormControlLabel"}),{checked:u,className:p,componentsProps:g={},control:y,disabled:C,disableTypography:S,inputRef:A,label:I,labelPlacement:D="end",name:k,onChange:N,required:x,slots:R={},slotProps:O={},value:P}=l,L=(0,i.A)(l,E),M=(0,c.A)(),F=null!==(n=null!==C&&void 0!==C?C:y.props.disabled)&&void 0!==n?n:null===M||void 0===M?void 0:M.disabled,V=null!==x&&void 0!==x?x:y.props.required,U={disabled:F,required:V};["checked","name","onChange","value","inputRef"].forEach(t=>{"undefined"===typeof y.props[t]&&"undefined"!==typeof l[t]&&(U[t]=l[t])});const j=(0,v.A)({props:l,muiFormControl:M,states:["error"]}),B=(0,r.A)((0,r.A)({},l),{},{disabled:F,labelPlacement:D,required:V,error:j.error}),q=(t=>{const{classes:e,disabled:n,labelPlacement:r,error:i,required:s}=t,o={root:["root",n&&"disabled","labelPlacement".concat((0,f.A)(r)),i&&"error",s&&"required"],label:["label",n&&"disabled"],asterisk:["asterisk",i&&"error"]};return(0,a.A)(o,m,e)})(B),z={slots:R,slotProps:(0,r.A)((0,r.A)({},g),O)},[K,H]=(0,w.A)("typography",{elementType:d.A,externalForwardedProps:z,ownerState:B});let G=I;return null==G||G.type===d.A||S||(G=(0,b.jsx)(K,(0,r.A)((0,r.A)({component:"span"},H),{},{className:(0,o.A)(q.label,null===H||void 0===H?void 0:H.className),children:G}))),(0,b.jsxs)(T,(0,r.A)((0,r.A)({className:(0,o.A)(q.root,p),ownerState:B,ref:e},L),{},{children:[s.cloneElement(y,U),V?(0,b.jsxs)("div",{children:[G,(0,b.jsxs)(_,{ownerState:B,"aria-hidden":!0,className:q.asterisk,children:["\u2009","*"]})]}):G]}))})},5437:(t,e,n)=>{n.d(e,{P5:()=>It});var r=n(52),i=n(443),s=n(1529),o=n(8812),a=n(2799);const c="@firebase/installations",l="0.6.18",u=1e4,h="w:".concat(l),d="FIS_v2",f=36e5,p={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},g=new s.FA("installations","Installations",p);function m(t){return t instanceof s.g&&t.code.includes("request-failed")}function y(t){let{projectId:e}=t;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(e,"/installations")}function v(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function w(t,e){const n=(await e.json()).error;return g.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function b(t){let{apiKey:e}=t;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function E(t,e){let{refreshToken:n}=e;const r=b(t);return r.append("Authorization",function(t){return"".concat(d," ").concat(t)}(n)),r}async function T(t){const e=await t();return e.status>=500&&e.status<600?t():e}function _(t){return new Promise(e=>{setTimeout(e,t)})}const C=/^[cdef][\w-]{21}$/;function S(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){const e=(n=t,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return e.substr(0,22)}(t);return C.test(e)?e:""}catch(t){return""}}function A(t){return"".concat(t.appName,"!").concat(t.appId)}const I=new Map;function D(t,e){const n=A(t);k(n,e),function(t,e){const n=x();n&&n.postMessage({key:t,fid:e});R()}(n,e)}function k(t,e){const n=I.get(t);if(n)for(const r of n)r(e)}let N=null;function x(){return!N&&"BroadcastChannel"in self&&(N=new BroadcastChannel("[Firebase] FID Change"),N.onmessage=t=>{k(t.data.key,t.data.fid)}),N}function R(){0===I.size&&N&&(N.close(),N=null)}const O="firebase-installations-store";let P=null;function L(){return P||(P=(0,a.P2)("firebase-installations-database",1,{upgrade:(t,e)=>{if(0===e)t.createObjectStore(O)}})),P}async function M(t,e){const n=A(t),r=(await L()).transaction(O,"readwrite"),i=r.objectStore(O),s=await i.get(n);return await i.put(e,n),await r.done,s&&s.fid===e.fid||D(t,e.fid),e}async function F(t){const e=A(t),n=(await L()).transaction(O,"readwrite");await n.objectStore(O).delete(e),await n.done}async function V(t,e){const n=A(t),r=(await L()).transaction(O,"readwrite"),i=r.objectStore(O),s=await i.get(n),o=e(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.done,!o||s&&s.fid===o.fid||D(t,o.fid),o}async function U(t){let e;const n=await V(t.appConfig,n=>{const r=function(t){const e=t||{fid:S(),registrationStatus:0};return q(e)}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine){return{installationEntry:e,registrationPromise:Promise.reject(g.create("app-offline"))}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(t,e){try{const n=await async function(t,e){let{appConfig:n,heartbeatServiceProvider:r}=t,{fid:i}=e;const s=y(n),o=b(n),a=r.getImmediate({optional:!0});if(a){const t=await a.getHeartbeatsHeader();t&&o.append("x-firebase-client",t)}const c={fid:i,authVersion:d,appId:n.appId,sdkVersion:h},l={method:"POST",headers:o,body:JSON.stringify(c)},u=await T(()=>fetch(s,l));if(u.ok){const t=await u.json();return{fid:t.fid||i,registrationStatus:2,refreshToken:t.refreshToken,authToken:v(t.authToken)}}throw await w("Create Installation",u)}(t,e);return M(t.appConfig,n)}catch(n){throw m(n)&&409===n.customData.serverCode?await F(t.appConfig):await M(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:j(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry});return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function j(t){let e=await B(t.appConfig);for(;1===e.registrationStatus;)await _(100),e=await B(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await U(t);return n||e}return e}function B(t){return V(t,t=>{if(!t)throw g.create("installation-not-found");return q(t)})}function q(t){return 1===(e=t).registrationStatus&&e.registrationTime+u<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function z(t,e){let{appConfig:n,heartbeatServiceProvider:r}=t;const i=function(t,e){let{fid:n}=e;return"".concat(y(t),"/").concat(n,"/authTokens:generate")}(n,e),s=E(n,e),o=r.getImmediate({optional:!0});if(o){const t=await o.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const a={installation:{sdkVersion:h,appId:n.appId}},c={method:"POST",headers:s,body:JSON.stringify(a)},l=await T(()=>fetch(i,c));if(l.ok){return v(await l.json())}throw await w("Generate Auth Token",l)}async function K(t){let e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=await V(t.appConfig,r=>{if(!G(r))throw g.create("not-registered");const i=r.authToken;if(!n&&function(t){return 2===t.requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+f}(t)}(i))return r;if(1===i.requestStatus)return e=async function(t,e){let n=await H(t.appConfig);for(;1===n.authToken.requestStatus;)await _(100),n=await H(t.appConfig);const r=n.authToken;return 0===r.requestStatus?K(t,e):r}(t,n),r;{if(!navigator.onLine)throw g.create("app-offline");const n=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(r);return e=async function(t,e){try{const n=await z(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await M(t.appConfig,r),n}catch(n){if(!m(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await M(t.appConfig,n)}else await F(t.appConfig);throw n}}(t,n),n}});return e?await e:r.authToken}function H(t){return V(t,t=>{if(!G(t))throw g.create("not-registered");const e=t.authToken;return 1===(n=e).requestStatus&&n.requestTime+u<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var n})}function G(t){return void 0!==t&&2===t.registrationStatus}async function W(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t;await async function(t){const{registrationPromise:e}=await U(t);e&&await e}(n);return(await K(n,e)).token}function Q(t){return g.create("missing-app-config-values",{valueName:t})}const X="installations",J=t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw Q("App Configuration");if(!t.name)throw Q("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Q(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:(0,r.j6)(e,"heartbeat"),_delete:()=>Promise.resolve()}},Y=t=>{const e=t.getProvider("app").getImmediate(),n=(0,r.j6)(e,X).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:r}=await U(e);return r?r.catch(console.error):K(e).catch(console.error),n.fid}(n),getToken:t=>W(n,t)}};(0,r.om)(new o.uA(X,J,"PUBLIC")),(0,r.om)(new o.uA("installations-internal",Y,"PRIVATE")),(0,r.KO)(c,l),(0,r.KO)(c,l,"esm2017");const $="analytics",Z="https://www.googletagmanager.com/gtag/js",tt=new i.Vy("@firebase/analytics"),et={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},nt=new s.FA("analytics","Analytics",et);function rt(t){if(!t.startsWith(Z)){const e=nt.create("invalid-gtag-resource",{gtagURL:t});return tt.warn(e.message),""}return t}function it(t){return Promise.all(t.map(t=>t.catch(t=>t)))}function st(t,e){const n=function(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}("firebase-js-sdk-policy",{createScriptURL:rt}),r=document.createElement("script"),i="".concat(Z,"?l=").concat(t,"&id=").concat(e);r.src=n?null===n||void 0===n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function ot(t,e,n,r){return async function(i){try{for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];if("event"===i){const[r,i]=o;await async function(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let t=i.send_to;Array.isArray(t)||(t=[t]);const r=await it(n);for(const n of t){const t=r.find(t=>t.measurementId===n),i=t&&e[t.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){tt.error(s)}}(t,e,n,r,i)}else if("config"===i){const[i,s]=o;await async function(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const t=(await it(n)).find(t=>t.measurementId===i);t&&await e[t.appId]}}catch(a){tt.error(a)}t("config",i,s)}(t,e,n,r,i,s)}else if("consent"===i){const[e,n]=o;t("consent",e,n)}else if("get"===i){const[e,n,r]=o;t("get",e,n,r)}else if("set"===i){const[e]=o;t("set",e)}else t(i,...o)}catch(c){tt.error(c)}}}const at=new class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function ct(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function lt(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:at,n=arguments.length>2?arguments[2]:void 0;const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw nt.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw nt.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new ht;return setTimeout(async()=>{a.abort()},void 0!==n?n:6e4),ut({appId:r,apiKey:i,measurementId:s},o,a,e)}async function ut(t,e,n){let{throttleEndTimeMillis:r,backoffCount:i}=e,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:at;var a;const{appId:c,measurementId:l}=t;try{await function(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(nt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}(n,r)}catch(u){if(l)return tt.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(l)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===u||void 0===u?void 0:u.message,"]")),{appId:c,measurementId:l};throw u}try{const e=await async function(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:ct(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(a){}throw nt.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return o.deleteThrottleMetadata(c),e}catch(u){const e=u;if(!function(t){if(!(t instanceof s.g)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(e)){if(o.deleteThrottleMetadata(c),l)return tt.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(l)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===e||void 0===e?void 0:e.message,"]")),{appId:c,measurementId:l};throw u}const r=503===Number(null===(a=null===e||void 0===e?void 0:e.customData)||void 0===a?void 0:a.httpStatus)?(0,s.p9)(i,o.intervalMillis,30):(0,s.p9)(i,o.intervalMillis),h={throttleEndTimeMillis:Date.now()+r,backoffCount:i+1};return o.setThrottleMetadata(c,h),tt.debug("Calling attemptFetch again in ".concat(r," millis")),ut(t,h,n,o)}}class ht{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}let dt,ft;function pt(t){ft=t}function gt(t){dt=t}async function mt(t,e,n,r,i,o,a){var c;const l=lt(t);l.then(e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&tt.warn("The measurement ID in the local Firebase config (".concat(t.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(e.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(t=>tt.error(t)),e.push(l);const u=async function(){if(!(0,s.zW)())return tt.warn(nt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,s.eX)()}catch(t){return tt.warn(nt.create("indexeddb-unavailable",{errorInfo:null===t||void 0===t?void 0:t.toString()}).message),!1}return!0}().then(t=>t?r.getId():void 0),[h,d]=await Promise.all([l,u]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Z)&&n.src.includes(t))return n;return null})(o)||st(o,h.measurementId),ft&&(i("consent","default",ft),pt(void 0)),i("js",new Date);const f=null!==(c=null===a||void 0===a?void 0:a.config)&&void 0!==c?c:{};return f.origin="firebase",f.update=!0,null!=d&&(f.firebase_id=d),i("config",h.measurementId,f),dt&&(i("set",dt),gt(void 0)),h.measurementId}class yt{constructor(t){this.app=t}_delete(){return delete vt[this.app.options.appId],Promise.resolve()}}let vt={},wt=[];const bt={};let Et,Tt,_t="dataLayer",Ct="gtag",St=!1;function At(t,e,n){!function(){const t=[];if((0,s.sr)()&&t.push("This is a browser extension environment."),(0,s.dM)()||t.push("Cookies are not available."),t.length>0){const e=t.map((t,e)=>"(".concat(e+1,") ").concat(t)).join(" "),n=nt.create("invalid-analytics-context",{errorInfo:e});tt.warn(n.message)}}();const r=t.options.appId;if(!r)throw nt.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw nt.create("no-api-key");tt.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(t.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=vt[r])throw nt.create("already-exists",{id:r});if(!St){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(_t);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,r,i){let s=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(s=window[i]),window[i]=ot(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}(vt,wt,bt,_t,Ct);Tt=t,Et=e,St=!0}vt[r]=mt(t,wt,bt,e,Et,_t,n);return new yt(t)}function It(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)();t=(0,s.Ku)(t);const e=(0,r.j6)(t,$);return e.isInitialized()?e.getImmediate():function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,r.j6)(t,$);if(n.isInitialized()){const t=n.getImmediate();if((0,s.bD)(e,n.getOptions()))return t;throw nt.create("already-initialized")}const i=n.initialize({options:e});return i}(t)}function Dt(t,e,n,r){t=(0,s.Ku)(t),async function(t,e,n,r,i){if(i&&i.global)t("event",n,r);else{const i=await e;t("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(Tt,vt[t.app.options.appId],e,n,r).catch(t=>tt.error(t))}const kt="@firebase/analytics",Nt="0.10.17";(0,r.om)(new o.uA($,(t,e)=>{let{options:n}=e;return At(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),n)},"PUBLIC")),(0,r.om)(new o.uA("analytics-internal",function(t){try{const e=t.getProvider($).getImmediate();return{logEvent:(t,n,r)=>Dt(e,t,n,r)}}catch(e){throw nt.create("interop-component-reg-failed",{reason:e})}},"PRIVATE")),(0,r.KO)(kt,Nt),(0,r.KO)(kt,Nt,"esm2017")},5472:(t,e,n)=>{n.d(e,{rJ:()=>pa,aU:()=>ba,aQ:()=>Ba});var r,i,s=n(52),o=n(8812),a=n(443),c=n(1529),l="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},u={};(function(){var t;function e(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(t,e,n){n||(n=0);var r=Array(16);if("string"===typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function s(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}!function(t,e){function n(){}n.prototype=e.prototype,t.D=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.C=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}(e,function(){this.blockSize=-1}),e.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},e.prototype.u=function(t,e){void 0===e&&(e=t.length);for(var r=e-this.blockSize,i=this.B,s=this.h,o=0;o<e;){if(0==s)for(;o<=r;)n(this,t,o),o+=this.blockSize;if("string"===typeof t){for(;o<e;)if(i[s++]=t.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<e;)if(i[s++]=t[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=e},e.prototype.v=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.o;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.u(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var o={};function a(t){return-128<=t&&128>t?function(t,e){var n=o;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(t){return new s([0|t],0>t?-1:0)}):new s([0|t],0>t?-1:0)}function c(t){if(isNaN(t)||!isFinite(t))return l;if(0>t)return g(c(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=4294967296;return new s(e,0)}var l=a(0),h=a(1),d=a(16777216);function f(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function p(t){return-1==t.h}function g(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new s(n,~t.h).add(h)}function m(t,e){return t.add(g(e))}function y(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function v(t,e){this.g=t,this.h=e}function w(t,e){if(f(e))throw Error("division by zero");if(f(t))return new v(l,l);if(p(t))return e=w(g(t),e),new v(g(e.g),g(e.h));if(p(e))return e=w(t,g(e)),new v(g(e.g),e.h);if(30<t.g.length){if(p(t)||p(e))throw Error("slowDivide_ only works with positive integers.");for(var n=h,r=e;0>=r.l(t);)n=b(n),r=b(r);var i=E(n,1),s=E(r,1);for(r=E(r,2),n=E(n,2);!f(r);){var o=s.add(r);0>=o.l(t)&&(i=i.add(n),s=o),r=E(r,1),n=E(n,1)}return e=m(t,i.j(e)),new v(i,e)}for(i=l;0<=t.l(e);){for(n=Math.max(1,Math.floor(t.m()/e.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=c(n)).j(e);p(o)||0<o.l(t);)o=(s=c(n-=r)).j(e);f(s)&&(s=h),i=i.add(s),t=m(t,o)}return new v(i,t)}function b(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.i(r)<<1|t.i(r-1)>>>31;return new s(n,t.h)}function E(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],o=0;o<r;o++)i[o]=0<e?t.i(o+n)>>>e|t.i(o+n+1)<<32-e:t.i(o+n);return new s(i,t.h)}(t=s.prototype).m=function(){if(p(this))return-g(this).m();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.i(n);t+=(0<=r?r:4294967296+r)*e,e*=4294967296}return t},t.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(f(this))return"0";if(p(this))return"-"+g(this).toString(t);for(var e=c(Math.pow(t,6)),n=this,r="";;){var i=w(n,e).g,s=((0<(n=m(n,i.j(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(f(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},t.i=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},t.l=function(t){return p(t=m(this,t))?-1:f(t)?0:1},t.abs=function(){return p(this)?g(this):this},t.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var o=r+(65535&this.i(i))+(65535&t.i(i)),a=(o>>>16)+(this.i(i)>>>16)+(t.i(i)>>>16);r=a>>>16,o&=65535,a&=65535,n[i]=a<<16|o}return new s(n,-2147483648&n[n.length-1]?-1:0)},t.j=function(t){if(f(this)||f(t))return l;if(p(this))return p(t)?g(this).j(g(t)):g(g(this).j(t));if(p(t))return g(this.j(g(t)));if(0>this.l(d)&&0>t.l(d))return c(this.m()*t.m());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var o=this.i(r)>>>16,a=65535&this.i(r),u=t.i(i)>>>16,h=65535&t.i(i);n[2*r+2*i]+=a*h,y(n,2*r+2*i),n[2*r+2*i+1]+=o*h,y(n,2*r+2*i+1),n[2*r+2*i+1]+=a*u,y(n,2*r+2*i+1),n[2*r+2*i+2]+=o*u,y(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new s(n,0)},t.A=function(t){return w(this,t).h},t.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.i(r)&t.i(r);return new s(n,this.h&t.h)},t.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.i(r)|t.i(r);return new s(n,this.h|t.h)},t.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.i(r)^t.i(r);return new s(n,this.h^t.h)},e.prototype.digest=e.prototype.v,e.prototype.reset=e.prototype.s,e.prototype.update=e.prototype.u,i=u.Md5=e,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return g(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=c(Math.pow(n,8)),i=l,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=c(Math.pow(n,o)),i=i.j(o).add(c(a))):i=(i=i.j(r)).add(c(a))}return i},r=u.Integer=s}).apply("undefined"!==typeof l?l:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var h,d,f,p,g,m,y,v,w="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},b={};(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){return t==Array.prototype||t==Object.prototype||(t[e]=n.value),t};var n=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof w&&w];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(t,r){if(r)t:{var i=n;t=t.split(".");for(var s=0;s<t.length-1;s++){var o=t[s];if(!(o in i))break t;i=i[o]}(r=r(s=i[t=t[t.length-1]]))!=s&&null!=r&&e(i,t,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",function(t){return t||function(){return function(t,e){t instanceof String&&(t+="");var n=0,r=!1,i={next:function(){if(!r&&n<t.length){var i=n++;return{value:e(i,t[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,function(t,e){return e})}});var r=r||{},i=this||self;function s(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function o(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function a(t,e,n){return t.call.apply(t.bind,arguments)}function c(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function l(t,e,n){return(l=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:c).apply(null,arguments)}function u(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function E(t,e){function n(){}n.prototype=e.prototype,t.aa=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Qb=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function T(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function _(t,e){for(let n=1;n<arguments.length;n++){const e=arguments[n];if(s(e)){const n=t.length||0,r=e.length||0;t.length=n+r;for(let i=0;i<r;i++)t[n+i]=e[i]}else t.push(e)}}function C(t){return/^[\s\xa0]*$/.test(t)}function S(){var t=i.navigator;return t&&(t=t.userAgent)?t:""}function A(t){return A[" "](t),t}A[" "]=function(){};var I=-1!=S().indexOf("Gecko")&&!(-1!=S().toLowerCase().indexOf("webkit")&&-1==S().indexOf("Edge"))&&!(-1!=S().indexOf("Trident")||-1!=S().indexOf("MSIE"))&&-1==S().indexOf("Edge");function D(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function k(t){const e={};for(const n in t)e[n]=t[n];return e}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function x(t,e){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(let e=0;e<N.length;e++)n=N[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function R(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function O(t){i.setTimeout(()=>{throw t},0)}function P(){var t=U;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var L=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new M,t=>t.reset());class M{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}let F,V=!1,U=new class{constructor(){this.h=this.g=null}add(t,e){const n=L.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}},j=()=>{const t=i.Promise.resolve(void 0);F=()=>{t.then(B)}};var B=()=>{for(var t;t=P();){try{t.h.call(t.g)}catch(n){O(n)}var e=L;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}V=!1};function q(){this.s=this.s,this.C=this.C}function z(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},z.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};i.addEventListener("test",t,e),i.removeEventListener("test",t,e)}catch(n){}return t}();function H(t,e){if(z.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(I){t:{try{A(e.nodeName);var i=!0;break t}catch(s){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:G[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&H.aa.h.call(this)}}E(H,z);var G={2:"touch",3:"pen",4:"mouse"};H.prototype.h=function(){H.aa.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var W="closure_listenable_"+(1e6*Math.random()|0),Q=0;function X(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ha=i,this.key=++Q,this.da=this.fa=!1}function J(t){t.da=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function Y(t){this.src=t,this.g={},this.h=0}function $(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],s=Array.prototype.indexOf.call(i,e,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(J(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Z(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.da&&s.listener==e&&s.capture==!!n&&s.ha==r)return i}return-1}Y.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Z(t,e,r,i);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new X(e,this.src,s,!!r,i)).fa=n,t.push(e)),e};var tt="closure_lm_"+(1e6*Math.random()|0),et={};function nt(t,e,n,r,i){if(r&&r.once)return it(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)nt(t,e[s],n,r,i);return null}return n=ht(n),t&&t[W]?t.K(e,n,o(r)?!!r.capture:!!r,i):rt(t,e,n,!1,r,i)}function rt(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,c=lt(t);if(c||(t[tt]=c=new Y(t)),(n=c.add(e,n,r,a,s)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}const e=ct;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)K||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(at(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function it(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)it(t,e[s],n,r,i);return null}return n=ht(n),t&&t[W]?t.L(e,n,o(r)?!!r.capture:!!r,i):rt(t,e,n,!0,r,i)}function st(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)st(t,e[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=ht(n),t&&t[W]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=Z(s=t.g[e],n,r,i))&&(J(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--)))):t&&(t=lt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Z(e,n,r,i)),(n=-1<t?e[t]:null)&&ot(n))}function ot(t){if("number"!==typeof t&&t&&!t.da){var e=t.src;if(e&&e[W])$(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(at(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=lt(e))?($(n,t),0==n.h&&(n.src=null,e[tt]=null)):J(t)}}}function at(t){return t in et?et[t]:et[t]="on"+t}function ct(t,e){if(t.da)t=!0;else{e=new H(e,this);var n=t.listener,r=t.ha||t.src;t.fa&&ot(t),t=n.call(r,e)}return t}function lt(t){return(t=t[tt])instanceof Y?t:null}var ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function ht(t){return"function"===typeof t?t:(t[ut]||(t[ut]=function(e){return t.handleEvent(e)}),t[ut])}function dt(){q.call(this),this.i=new Y(this),this.M=this,this.F=null}function ft(t,e){var n,r=t.F;if(r)for(n=[];r;r=r.F)n.push(r);if(t=t.M,r=e.type||e,"string"===typeof e)e=new z(e,t);else if(e instanceof z)e.target=e.target||t;else{var i=e;x(e=new z(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=pt(o,r,!0,e)&&i}if(i=pt(o=e.g=t,r,!0,e)&&i,i=pt(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=pt(o=e.g=n[s],r,!1,e)&&i}function pt(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.da&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.fa&&$(t.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}function gt(t,e,n){if("function"===typeof t)n&&(t=l(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=l(t.handleEvent,t)}return 2147483647<Number(e)?-1:i.setTimeout(t,e||0)}function mt(t){t.g=gt(()=>{t.g=null,t.i&&(t.i=!1,mt(t))},t.l);const e=t.h;t.h=null,t.m.apply(null,e)}E(dt,q),dt.prototype[W]=!0,dt.prototype.removeEventListener=function(t,e,n,r){st(this,t,e,n,r)},dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)J(n[r]);delete e.g[t],e.h--}}this.F=null},dt.prototype.K=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},dt.prototype.L=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};class yt extends q{constructor(t,e){super(),this.m=t,this.l=e,this.h=null,this.i=!1,this.g=null}j(t){this.h=arguments,this.g?this.i=!0:mt(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vt(t){q.call(this),this.h=t,this.g={}}E(vt,q);var wt=[];function bt(t){D(t.g,function(t,e){this.g.hasOwnProperty(e)&&ot(t)},t),t.g={}}vt.prototype.N=function(){vt.aa.N.call(this),bt(this)},vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Et=i.JSON.stringify,Tt=i.JSON.parse,_t=class{stringify(t){return i.JSON.stringify(t,void 0)}parse(t){return i.JSON.parse(t,void 0)}};function Ct(){}function St(t){return t.h||(t.h=t.i())}function At(){}Ct.prototype.h=null;var It={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Dt(){z.call(this,"d")}function kt(){z.call(this,"c")}E(Dt,z),E(kt,z);var Nt={},xt=null;function Rt(){return xt=xt||new dt}function Ot(t){z.call(this,Nt.La,t)}function Pt(t){const e=Rt();ft(e,new Ot(e))}function Lt(t,e){z.call(this,Nt.STAT_EVENT,t),this.stat=e}function Mt(t){const e=Rt();ft(e,new Lt(e,t))}function Ft(t,e){z.call(this,Nt.Ma,t),this.size=e}function Vt(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){t()},e)}function Ut(){this.g=!0}function jt(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Et(n)}catch(a){return e}}(t,n)+(r?" "+r:"")})}Nt.La="serverreachability",E(Ot,z),Nt.STAT_EVENT="statevent",E(Lt,z),Nt.Ma="timingevent",E(Ft,z),Ut.prototype.xa=function(){this.g=!1},Ut.prototype.info=function(){};var Bt,qt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},zt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Kt(){}function Ht(t,e,n,r){this.j=t,this.i=e,this.l=n,this.R=r||1,this.U=new vt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Gt}function Gt(){this.i=null,this.g="",this.h=!1}E(Kt,Ct),Kt.prototype.g=function(){return new XMLHttpRequest},Kt.prototype.i=function(){return{}},Bt=new Kt;var Wt={},Qt={};function Xt(t,e,n){t.L=1,t.v=Ee(me(e)),t.m=n,t.P=!0,Jt(t,null)}function Jt(t,e){t.F=Date.now(),Zt(t),t.A=me(t.v);var n=t.A,r=t.R;Array.isArray(r)||(r=[String(r)]),Le(n.i,"t",r),t.C=0,n=t.j.J,t.h=new Gt,t.g=_n(t.j,n?e:null,!t.m),0<t.O&&(t.M=new yt(l(t.Y,t,t.g),t.O)),e=t.U,n=t.g,r=t.ca;var i="readystatechange";Array.isArray(i)||(i&&(wt[0]=i.toString()),i=wt);for(var s=0;s<i.length;s++){var o=nt(n,i[s],r||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}e=t.H?k(t.H):{},t.m?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.m,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Pt(),function(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o})}(t.i,t.u,t.A,t.l,t.R,t.m)}function Yt(t){return!!t.g&&("GET"==t.u&&2!=t.L&&t.j.Ca)}function $t(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Qt:(n=Number(e.substring(n,r)),isNaN(n)?Wt:(r+=1)+n>e.length?Qt:(e=e.slice(r,r+n),t.C=r+n,e))}function Zt(t){t.S=Date.now()+t.I,te(t,t.I)}function te(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Vt(l(t.ba,t),e)}function ee(t){t.B&&(i.clearTimeout(t.B),t.B=null)}function ne(t){0==t.j.G||t.J||vn(t.j,t)}function re(t){ee(t);var e=t.M;e&&"function"==typeof e.ma&&e.ma(),t.M=null,bt(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.ma())}function ie(t,e){try{var n=t.j;if(0!=n.G&&(n.g==t||le(n.h,t)))if(!t.K&&le(n.h,t)&&3==n.G){try{var r=n.Da.g.parse(e)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;yn(n),an(n)}pn(n),Mt(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Vt(l(n.Za,n),6e3));if(1>=ce(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else bn(n,11)}else if((t.K||n.g==t)&&yn(n),!C(e))for(i=n.Da.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.K=l[1],n.ia=l[2];const e=l[3];null!=e&&(n.la=e,n.j.info("VER="+n.la));const i=l[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=l[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=r.h;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ue(s,s.h),s.h=null))}if(r.D){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.ya=t,be(r.I,r.D,t))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-t.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=t;if((r=n).qa=Tn(r,r.J?r.ia:null,r.W),o.K){he(r.h,o);var a=o,c=r.L;c&&(a.I=c),a.B&&(ee(a),Zt(a)),r.g=o}else fn(r);0<n.i.length&&ln(n)}else"stop"!=l[0]&&"close"!=l[0]||bn(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?bn(n,7):on(n):"noop"!=l[0]&&n.l&&n.l.ta(l),n.v=0)}Pt()}catch(u){}}Ht.prototype.ca=function(t){t=t.target;const e=this.M;e&&3==en(t)?e.j():this.Y(t)},Ht.prototype.Y=function(t){try{if(t==this.g)t:{const d=en(this.g);var e=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||nn(this.g)))){this.J||4!=d||7==e||Pt(),ee(this);var n=this.g.Z();this.X=n;e:if(Yt(this)){var r=nn(this.g);t="";var s=r.length,o=4==en(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){re(this),ne(this);var a="";break e}this.h.i=new i.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:!(o&&e==s-1)});r.length=0,this.h.g+=t,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o})}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(c)){var u=c;break e}}u=null}if(!(n=u)){this.o=!1,this.s=3,Mt(12),re(this),ne(this);break t}jt(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ie(this,n)}if(this.P){let t;for(n=!0;!this.J&&this.C<a.length;){if(t=$t(this,a),t==Qt){4==d&&(this.s=4,Mt(14),n=!1),jt(this.i,this.l,null,"[Incomplete Response]");break}if(t==Wt){this.s=4,Mt(15),jt(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}jt(this.i,this.l,t,null),ie(this,t)}if(Yt(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,Mt(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),gn(h),h.M=!0,Mt(11))}}else jt(this.i,this.l,a,"[Invalid Chunked Response]"),re(this),ne(this)}else jt(this.i,this.l,a,null),ie(this,a);4==d&&re(this),this.o&&!this.J&&(4==d?vn(this.j,this):(this.o=!1,Zt(this)))}else(function(t){const e={};t=(t.g&&2<=en(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<t.length;r++){if(C(t[r]))continue;var n=R(t[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=e[i]||[];e[i]=s,s.push(n)}!function(t,e){for(const n in t)e.call(void 0,t[n],n,t)}(e,function(t){return t.join(", ")})})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,Mt(12)):(this.s=0,Mt(13)),re(this),ne(this)}}}catch(d){}},Ht.prototype.cancel=function(){this.J=!0,re(this)},Ht.prototype.ba=function(){this.B=null;const t=Date.now();0<=t-this.S?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.i,this.A),2!=this.L&&(Pt(),Mt(17)),re(this),this.s=2,ne(this)):te(this,this.S-t)};var se=class{constructor(t,e){this.g=t,this.map=e}};function oe(t){this.l=t||10,i.PerformanceNavigationTiming?t=0<(t=i.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ae(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ce(t){return t.h?1:t.g?t.g.size:0}function le(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ue(t,e){t.g?t.g.add(e):t.h=e}function he(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function de(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return T(t.i)}function fe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(s(t)||"string"===typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.na&&"function"==typeof t.na)return t.na();if(!t.V||"function"!=typeof t.V){if("undefined"!==typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!==typeof Set&&t instanceof Set)){if(s(t)||"string"===typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function(t){if(t.V&&"function"==typeof t.V)return t.V();if("undefined"!==typeof Map&&t instanceof Map||"undefined"!==typeof Set&&t instanceof Set)return Array.from(t.values());if("string"===typeof t)return t.split("");if(s(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}oe.prototype.cancel=function(){if(this.i=de(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var pe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ge(t){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,t instanceof ge){this.h=t.h,ye(this,t.j),this.o=t.o,this.g=t.g,ve(this,t.s),this.l=t.l;var e=t.i,n=new xe;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),we(this,n),this.m=t.m}else t&&(e=String(t).match(pe))?(this.h=!1,ye(this,e[1]||"",!0),this.o=Te(e[2]||""),this.g=Te(e[3]||"",!0),ve(this,e[4]),this.l=Te(e[5]||"",!0),we(this,e[6]||"",!0),this.m=Te(e[7]||"")):(this.h=!1,this.i=new xe(null,this.h))}function me(t){return new ge(t)}function ye(t,e,n){t.j=n?Te(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function ve(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.s=e}else t.s=null}function we(t,e,n){e instanceof xe?(t.i=e,function(t,e){e&&!t.j&&(Re(t),t.i=null,t.g.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Oe(this,e),Le(this,n,t))},t)),t.j=e}(t.i,t.h)):(n||(e=_e(e,ke)),t.i=new xe(e,t.h))}function be(t,e,n){t.i.set(e,n)}function Ee(t){return be(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Te(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function _e(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,Ce),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ce(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ge.prototype.toString=function(){var t=[],e=this.j;e&&t.push(_e(e,Ae,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.o)&&t.push(_e(e,Ae,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(_e(n,"/"==n.charAt(0)?De:Ie,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.m)&&t.push("#",_e(n,Ne)),t.join("")};var Se,Ae=/[#\/\?@]/g,Ie=/[#\?:]/g,De=/[#\?]/g,ke=/[#\?@]/g,Ne=/#/g;function xe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Re(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Oe(t,e){Re(t),e=Me(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Pe(t,e){return Re(t),e=Me(t,e),t.g.has(e)}function Le(t,e,n){Oe(t,e),0<n.length&&(t.i=null,t.g.set(Me(t,e),T(n)),t.h+=n.length)}function Me(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Fe(t,e,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function Ve(){this.g=new _t}function Ue(t,e,n){const r=n||"";try{fe(t,function(t,n){let i=t;o(t)&&(i=Et(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function je(t){this.l=t.Ub||null,this.j=t.eb||!1}function Be(t,e){dt.call(this),this.D=t,this.o=e,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function qe(t){t.j.read().then(t.Pa.bind(t)).catch(t.ga.bind(t))}function ze(t){t.readyState=4,t.l=null,t.j=null,t.v=null,Ke(t)}function Ke(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function He(t){let e="";return D(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function Ge(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=He(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):be(t,e,n))}function We(t){dt.call(this),this.headers=new Map,this.o=t||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=xe.prototype).add=function(t,e){Re(this),this.i=null,t=Me(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},t.forEach=function(t,e){Re(this),this.g.forEach(function(n,r){n.forEach(function(n){t.call(e,n,r,this)},this)},this)},t.na=function(){Re(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let t=0;t<i.length;t++)n.push(e[r])}return n},t.V=function(t){Re(this);let e=[];if("string"===typeof t)Pe(this,t)&&(e=e.concat(this.g.get(Me(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},t.set=function(t,e){return Re(this),this.i=null,Pe(this,t=Me(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")},E(je,Ct),je.prototype.g=function(){return new Be(this.l,this.j)},je.prototype.i=(Se={},function(){return Se}),E(Be,dt),(t=Be.prototype).open=function(t,e){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=t,this.A=e,this.readyState=1,Ke(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.u,method:this.B,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||i).fetch(new Request(this.A,e)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ze(this)),this.readyState=0},t.Sa=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ke(this)),this.g&&(this.readyState=3,Ke(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;qe(this)}else t.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(t){if(this.g){if(this.o&&t.value)this.response.push(t.value);else if(!this.o){var e=t.value?t.value:new Uint8Array(0);(e=this.v.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?ze(this):Ke(this),3==this.readyState&&qe(this)}},t.Ra=function(t){this.g&&(this.response=this.responseText=t,ze(this))},t.Qa=function(t){this.g&&(this.response=t,ze(this))},t.ga=function(){this.g&&ze(this)},t.setRequestHeader=function(t,e){this.u.append(t,e)},t.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Be.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}}),E(We,dt);var Qe=/^https?$/i,Xe=["POST","PUT"];function Je(t,e){t.h=!1,t.g&&(t.j=!0,t.g.abort(),t.j=!1),t.l=e,t.m=5,Ye(t),Ze(t)}function Ye(t){t.A||(t.A=!0,ft(t,"complete"),ft(t,"error"))}function $e(t){if(t.h&&"undefined"!=typeof r&&(!t.v[1]||4!=en(t)||2!=t.Z()))if(t.u&&4==en(t))gt(t.Ea,0,t);else if(ft(t,"readystatechange"),4==en(t)){t.h=!1;try{const r=t.Z();t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var s;if(s=0===r){var o=String(t.D).match(pe)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!Qe.test(o?o.toLowerCase():"")}n=s}if(n)ft(t,"complete"),ft(t,"success");else{t.m=6;try{var a=2<en(t)?t.g.statusText:""}catch(c){a=""}t.l=a+" ["+t.Z()+"]",Ye(t)}}finally{Ze(t)}}}function Ze(t,e){if(t.g){tn(t);const r=t.g,i=t.v[0]?()=>{}:null;t.g=null,t.v=null,e||ft(t,"ready");try{r.onreadystatechange=i}catch(n){}}}function tn(t){t.I&&(i.clearTimeout(t.I),t.I=null)}function en(t){return t.g?t.g.readyState:0}function nn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.H){case"":case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function rn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function sn(t){this.Aa=0,this.i=[],this.j=new Ut,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rn("failFast",!1,t),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rn("baseRetryDelayMs",5e3,t),this.cb=rn("retryDelaySeedMs",1e4,t),this.Wa=rn("forwardChannelMaxRetries",2,t),this.wa=rn("forwardChannelRequestTimeoutMs",2e4,t),this.pa=t&&t.xmlHttpFactory||void 0,this.Xa=t&&t.Tb||void 0,this.Ca=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.h=new oe(t&&t.concurrentRequestLimit),this.Da=new Ve,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=t&&t.Rb||!1,t&&t.xa&&this.j.xa(),t&&t.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&t&&t.detectBufferingProxy||!1,this.ja=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.ja=t.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function on(t){if(cn(t),3==t.G){var e=t.U++,n=me(t.I);if(be(n,"SID",t.K),be(n,"RID",e),be(n,"TYPE","terminate"),hn(t,n),(e=new Ht(t,t.j,e)).L=2,e.v=Ee(me(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(e.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=e.v,n=!0),n||(e.g=_n(e.j,null),e.g.ea(e.v)),e.F=Date.now(),Zt(e)}En(t)}function an(t){t.g&&(gn(t),t.g.cancel(),t.g=null)}function cn(t){an(t),t.u&&(i.clearTimeout(t.u),t.u=null),yn(t),t.h.cancel(),t.s&&("number"===typeof t.s&&i.clearTimeout(t.s),t.s=null)}function ln(t){if(!ae(t.h)&&!t.s){t.s=!0;var e=t.Ga;F||j(),V||(F(),V=!0),U.add(e,t),t.B=0}}function un(t,e){var n;n=e?e.l:t.U++;const r=me(t.I);be(r,"SID",t.K),be(r,"RID",n),be(r,"AID",t.T),hn(t,r),t.m&&t.o&&Ge(r,t.m,t.o),n=new Ht(t,t.j,n,t.B+1),null===t.m&&(n.H=t.o),e&&(t.i=e.D.concat(t.i)),e=dn(t,n,1e3),n.I=Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random()),ue(t.h,n),Xt(n,r,e)}function hn(t,e){t.H&&D(t.H,function(t,n){be(e,n,t)}),t.l&&fe({},function(t,n){be(e,n,t)})}function dn(t,e,n){n=Math.min(t.i.length,n);var r=t.l?l(t.l.Na,t.l,t):null;t:{var i=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let a=0;a<n;a++){let n=i[a].g;const c=i[a].map;if(n-=e,0>n)e=Math.max(0,i[a].g-100),o=!1;else try{Ue(c,t,"req"+n+"_")}catch(s){r&&r(c)}}if(o){r=t.join("&");break t}}}return t=t.i.splice(0,n),e.D=t,r}function fn(t){if(!t.g&&!t.u){t.Y=1;var e=t.Fa;F||j(),V||(F(),V=!0),U.add(e,t),t.v=0}}function pn(t){return!(t.g||t.u||3<=t.v)&&(t.Y++,t.u=Vt(l(t.Fa,t),wn(t,t.v)),t.v++,!0)}function gn(t){null!=t.A&&(i.clearTimeout(t.A),t.A=null)}function mn(t){t.g=new Ht(t,t.j,"rpc",t.Y),null===t.m&&(t.g.H=t.o),t.g.O=0;var e=me(t.qa);be(e,"RID","rpc"),be(e,"SID",t.K),be(e,"AID",t.T),be(e,"CI",t.F?"0":"1"),!t.F&&t.ja&&be(e,"TO",t.ja),be(e,"TYPE","xmlhttp"),hn(t,e),t.m&&t.o&&Ge(e,t.m,t.o),t.L&&(t.g.I=t.L);var n=t.g;t=t.ia,n.L=1,n.v=Ee(me(e)),n.m=null,n.P=!0,Jt(n,t)}function yn(t){null!=t.C&&(i.clearTimeout(t.C),t.C=null)}function vn(t,e){var n=null;if(t.g==e){yn(t),gn(t),t.g=null;var r=2}else{if(!le(t.h,e))return;n=e.D,he(t.h,e),r=1}if(0!=t.G)if(e.o)if(1==r){n=e.m?e.m.length:0,e=Date.now()-e.F;var i=t.B;ft(r=Rt(),new Ft(r,n)),ln(t)}else fn(t);else if(3==(i=e.s)||0==i&&0<e.X||!(1==r&&function(t,e){return!(ce(t.h)>=t.h.j-(t.s?1:0))&&(t.s?(t.i=e.D.concat(t.i),!0):!(1==t.G||2==t.G||t.B>=(t.Va?0:t.Wa))&&(t.s=Vt(l(t.Ga,t,e),wn(t,t.B)),t.B++,!0))}(t,e)||2==r&&pn(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),i){case 1:bn(t,5);break;case 4:bn(t,10);break;case 3:bn(t,6);break;default:bn(t,2)}}function wn(t,e){let n=t.Ta+Math.floor(Math.random()*t.cb);return t.isActive()||(n*=2),n*e}function bn(t,e){if(t.j.info("Error code "+e),2==e){var n=l(t.fb,t),r=t.Xa;const e=!r;r=new ge(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||ye(r,"https"),Ee(r),e?function(t,e){const n=new Ut;if(i.Image){const r=new Image;r.onload=u(Fe,n,"TestLoadImage: loaded",!0,e,r),r.onerror=u(Fe,n,"TestLoadImage: error",!1,e,r),r.onabort=u(Fe,n,"TestLoadImage: abort",!1,e,r),r.ontimeout=u(Fe,n,"TestLoadImage: timeout",!1,e,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(r.toString(),n):function(t,e){new Ut;const n=new AbortController,r=setTimeout(()=>{n.abort(),Fe(0,0,!1,e)},1e4);fetch(t,{signal:n.signal}).then(t=>{clearTimeout(r),t.ok?Fe(0,0,!0,e):Fe(0,0,!1,e)}).catch(()=>{clearTimeout(r),Fe(0,0,!1,e)})}(r.toString(),n)}else Mt(2);t.G=0,t.l&&t.l.sa(e),En(t),cn(t)}function En(t){if(t.G=0,t.ka=[],t.l){const e=de(t.h);0==e.length&&0==t.i.length||(_(t.ka,e),_(t.ka,t.i),t.h.i.length=0,T(t.i),t.i.length=0),t.l.ra()}}function Tn(t,e,n){var r=n instanceof ge?me(n):new ge(n);if(""!=r.g)e&&(r.g=e+"."+r.g),ve(r,r.s);else{var s=i.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var o=new ge(null);r&&ye(o,r),e&&(o.g=e),s&&ve(o,s),n&&(o.l=n),r=o}return n=t.D,e=t.ya,n&&e&&be(r,n,e),be(r,"VER",t.la),hn(t,r),r}function _n(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ca&&!t.pa?new We(new je({eb:n})):new We(t.pa)).Ha(t.J),e}function Cn(){}function Sn(){}function An(t,e){dt.call(this),this.g=new sn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.o=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.va&&(t?t["X-WebChannel-Client-Profile"]=e.va:t={"X-WebChannel-Client-Profile":e.va}),this.g.S=t,(t=e&&e.Sb)&&!C(t)&&(this.g.m=t),this.v=e&&e.supportsCrossDomainXhr||!1,this.u=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!C(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new kn(this)}function In(t){Dt.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function Dn(){kt.call(this),this.status=1}function kn(t){this.g=t}(t=We.prototype).Ha=function(t){this.J=t},t.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bt.g(),this.v=this.o?St(this.o):St(Bt),this.g.onreadystatechange=l(this.Ea,this);try{this.B=!0,this.g.open(e,String(t),!0),this.B=!1}catch(o){return void Je(this,o)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find(t=>"content-type"==t.toLowerCase()),s=i.FormData&&t instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Xe,e,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tn(this),this.u=!0,this.g.send(t),this.u=!1}catch(o){Je(this,o)}},t.abort=function(t){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=t||7,ft(this,"complete"),ft(this,"abort"),Ze(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ze(this,!0)),We.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?$e(this):this.bb())},t.bb=function(){$e(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<en(this)?this.g.status:-1}catch(Se){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(Se){return""}},t.Oa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Tt(e)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(t=sn.prototype).la=8,t.G=1,t.connect=function(t,e,n,r){Mt(0),this.W=t,this.H=e||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=Tn(this,null,this.W),ln(this)},t.Ga=function(t){if(this.s)if(this.s=null,1==this.G){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const i=new Ht(this,this.j,t);let s=this.o;if(this.S&&(s?(s=k(s),x(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)t:{for(var e=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=dn(this,i,e),be(n=me(this.I),"RID",t),be(n,"CVER",22),this.D&&be(n,"X-HTTP-Session-Id",this.D),hn(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(He(s)))+"&"+e:this.m&&Ge(n,this.m,s)),ue(this.h,i),this.Ua&&be(n,"TYPE","init"),this.P?(be(n,"$req",e),be(n,"SID","null"),i.T=!0,Xt(i,n,null)):Xt(i,n,e),this.G=2}}else 3==this.G&&(t?un(this,t):0==this.i.length||ae(this.h)||un(this))},t.Fa=function(){if(this.u=null,mn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var t=2*this.R;this.j.info("BP detection timer enabled: "+t),this.A=Vt(l(this.ab,this),t)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Mt(10),an(this),mn(this))},t.Za=function(){null!=this.C&&(this.C=null,an(this),pn(this),Mt(19))},t.fb=function(t){t?(this.j.info("Successfully pinged google.com"),Mt(2)):(this.j.info("Failed to ping google.com"),Mt(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=Cn.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},Sn.prototype.g=function(t,e){return new An(t,e)},E(An,dt),An.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},An.prototype.close=function(){on(this.g)},An.prototype.o=function(t){var e=this.g;if("string"===typeof t){var n={};n.__data__=t,t=n}else this.u&&((n={}).__data__=Et(t),t=n);e.i.push(new se(e.Ya++,t)),3==e.G&&ln(e)},An.prototype.N=function(){this.g.l=null,delete this.j,on(this.g),delete this.g,An.aa.N.call(this)},E(In,Dt),E(Dn,kt),E(kn,Cn),kn.prototype.ua=function(){ft(this.g,"a")},kn.prototype.ta=function(t){ft(this.g,new In(t))},kn.prototype.sa=function(t){ft(this.g,new Dn)},kn.prototype.ra=function(){ft(this.g,"b")},Sn.prototype.createWebChannel=Sn.prototype.g,An.prototype.send=An.prototype.o,An.prototype.open=An.prototype.m,An.prototype.close=An.prototype.close,v=b.createWebChannelTransport=function(){return new Sn},y=b.getStatEventTarget=function(){return Rt()},m=b.Event=Nt,g=b.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qt.NO_ERROR=0,qt.TIMEOUT=8,qt.HTTP_ERROR=6,p=b.ErrorCode=qt,zt.COMPLETE="complete",f=b.EventType=zt,At.EventType=It,It.OPEN="a",It.CLOSE="b",It.ERROR="c",It.MESSAGE="d",dt.prototype.listen=dt.prototype.K,d=b.WebChannel=At,b.FetchXmlHttpFactory=je,We.prototype.listenOnce=We.prototype.L,We.prototype.getLastError=We.prototype.Ka,We.prototype.getLastErrorCode=We.prototype.Ba,We.prototype.getStatus=We.prototype.Z,We.prototype.getResponseJson=We.prototype.Oa,We.prototype.getResponseText=We.prototype.oa,We.prototype.send=We.prototype.ea,We.prototype.setWithCredentials=We.prototype.Ha,h=b.XhrIo=We}).apply("undefined"!==typeof w?w:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const E="@firebase/firestore",T="4.8.0";class _{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}_.UNAUTHENTICATED=new _(null),_.GOOGLE_CREDENTIALS=new _("google-credentials-uid"),_.FIRST_PARTY=new _("first-party-uid"),_.MOCK_USER=new _("mock-user");let C="11.10.0";const S=new a.Vy("@firebase/firestore");function A(){return S.logLevel}function I(t){if(S.logLevel<=a.$b.DEBUG){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=n.map(N);S.debug("Firestore (".concat(C,"): ").concat(t),...i)}}function D(t){if(S.logLevel<=a.$b.ERROR){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=n.map(N);S.error("Firestore (".concat(C,"): ").concat(t),...i)}}function k(t){if(S.logLevel<=a.$b.WARN){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const i=n.map(N);S.warn("Firestore (".concat(C,"): ").concat(t),...i)}}function N(t){if("string"==typeof t)return t;try{return function(t){return JSON.stringify(t)}(t)}catch(e){return t}}function x(t,e,n){let r="Unexpected state";"string"==typeof e?r=e:n=e,R(t,r,n)}function R(t,e,n){let r="FIRESTORE (".concat(C,") INTERNAL ASSERTION FAILED: ").concat(e," (ID: ").concat(t.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(t){r+=" CONTEXT: "+n}throw D(r),new Error(r)}function O(t,e,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,t||R(e,i,r)}function P(t,e){return t}const L={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class M extends c.g{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class F{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class V{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))}}class U{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(_.UNAUTHENTICATED))}shutdown(){}}class j{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}}class B{constructor(t){this.t=t,this.currentUser=_.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){O(void 0===this.o,42304);let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new F;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new F,t.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const e=i;t.enqueueRetryable(async()=>{await e.promise,await r(this.currentUser)})},o=t=>{I("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(t=>o(t)),setTimeout(()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(I("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new F)}},0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.i!==t?(I("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(O("string"==typeof e.accessToken,31837,{l:e}),new V(e.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return O(null===t||"string"==typeof t,2055,{h:t}),new _(t)}}class q{constructor(t,e,n){this.P=t,this.T=e,this.I=n,this.type="FirstParty",this.user=_.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class z{constructor(t,e,n){this.P=t,this.T=e,this.I=n}getToken(){return Promise.resolve(new q(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable(()=>e(_.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class K{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class H{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,s.xZ)(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){O(void 0===this.o,3512);const n=t=>{null!=t.error&&I("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(t.error.message));const n=t.token!==this.m;return this.m=t.token,I("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable(()=>n(e))};const r=t=>{I("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(t=>r(t)),setTimeout(()=>{if(!this.appCheck){const t=this.V.getImmediate({optional:!0});t?r(t):I("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new K(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(t=>t?(O("string"==typeof t.token,44558,{tokenResult:t}),this.m=t.token,new K(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function G(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}function W(){return new TextEncoder}class Q{static newId(){const t=62*Math.floor(256/62);let e="";for(;e.length<20;){const n=G(40);for(let r=0;r<n.length;++r)e.length<20&&n[r]<t&&(e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return e}}function X(t,e){return t<e?-1:t>e?1:0}function J(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),i=e.codePointAt(n);if(r!==i){if(r<128&&i<128)return X(r,i);{const s=W(),o=$(s.encode(Y(t,n)),s.encode(Y(e,n)));return 0!==o?o:X(r,i)}}n+=r>65535?2:1}return X(t.length,e.length)}function Y(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function $(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return X(t[n],e[n]);return X(t.length,e.length)}function Z(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}const tt="__name__";class et{constructor(t,e,n){void 0===e?e=0:e>t.length&&x(637,{offset:e,range:t.length}),void 0===n?n=t.length-e:n>t.length-e&&x(1746,{length:n,range:t.length-e}),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===et.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof et?t.forEach(t=>{e.push(t)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=et.compareSegments(t.get(r),e.get(r));if(0!==n)return n}return X(t.length,e.length)}static compareSegments(t,e){const n=et.isNumericId(t),r=et.isNumericId(e);return n&&!r?-1:!n&&r?1:n&&r?et.extractNumericId(t).compare(et.extractNumericId(e)):J(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return r.fromString(t.substring(4,t.length-2))}}class nt extends et{construct(t,e,n){return new nt(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new M(L.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));t.push(...i.split("/").filter(t=>t.length>0))}return new nt(t)}static emptyPath(){return new nt([])}}const rt=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class it extends et{construct(t,e,n){return new it(t,e,n)}static isValidIdentifier(t){return rt.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),it.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===tt}static keyField(){return new it([tt])}static fromServerFormat(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new M(L.INVALID_ARGUMENT,"Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));e.push(n),n=""};let s=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new M(L.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new M(L.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(s=!s,r++):"."!==e||s?(n+=e,r++):(i(),r++)}if(i(),s)throw new M(L.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new it(e)}static emptyPath(){return new it([])}}class st{constructor(t){this.path=t}static fromPath(t){return new st(nt.fromString(t))}static fromName(t){return new st(nt.fromString(t).popFirst(5))}static empty(){return new st(nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===nt.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return nt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new st(new nt(t.slice()))}}function ot(t,e,n){if(!n)throw new M(L.INVALID_ARGUMENT,"Function ".concat(t,"() cannot be called with an empty ").concat(e,"."))}function at(t){if(st.isDocumentKey(t))throw new M(L.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(t," has ").concat(t.length,"."))}function ct(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function lt(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t="".concat(t.substring(0,20),"...")),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?"a custom ".concat(e," object"):"an object"}}return"function"==typeof t?"a function":x(12329,{type:typeof t})}function ut(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new M(L.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=lt(t);throw new M(L.INVALID_ARGUMENT,"Expected type '".concat(e.name,"', but it was: ").concat(n))}}return t}function ht(t,e){const n={typeString:t};return e&&(n.value=e),n}function dt(t,e){if(!ct(t))throw new M(L.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n="JSON missing required field: '".concat(r,"'");break}const o=t[r];if(i&&typeof o!==i){n="JSON field '".concat(r,"' must be a ").concat(i,".");break}if(void 0!==s&&o!==s.value){n="Expected '".concat(r,"' field to equal '").concat(s.value,"'");break}}if(n)throw new M(L.INVALID_ARGUMENT,n);return!0}const ft=-62135596800,pt=1e6;class gt{static now(){return gt.fromMillis(Date.now())}static fromDate(t){return gt.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor((t-1e3*e)*pt);return new gt(e,n)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new M(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new M(L.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<ft)throw new M(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new M(L.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/pt}_compareTo(t){return this.seconds===t.seconds?X(this.nanoseconds,t.nanoseconds):X(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(dt(t,gt._jsonSchema))return new gt(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-ft;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}gt._jsonSchemaVersion="firestore/timestamp/1.0",gt._jsonSchema={type:ht("string",gt._jsonSchemaVersion),seconds:ht("number"),nanoseconds:ht("number")};class mt{static fromTimestamp(t){return new mt(t)}static min(){return new mt(new gt(0,0))}static max(){return new mt(new gt(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const yt=-1;class vt{constructor(t,e,n,r){this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=r}}vt.UNKNOWN_ID=-1;function wt(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=mt.fromTimestamp(1e9===r?new gt(n+1,0):new gt(n,r));return new Et(i,st.empty(),e)}function bt(t){return new Et(t.readTime,t.key,yt)}class Et{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new Et(mt.min(),st.empty(),yt)}static max(){return new Et(mt.max(),st.empty(),yt)}}function Tt(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=st.comparator(t.documentKey,e.documentKey),0!==n?n:X(t.largestBatchId,e.largestBatchId))}const _t="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ct{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}}async function St(t){if(t.code!==L.FAILED_PRECONDITION||t.message!==_t)throw t;I("LocalStore","Unexpectedly lost primary lease")}class At{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&x(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new At((n,r)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,r)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,r)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{const e=t();return e instanceof At?e:At.resolve(e)}catch(t){return At.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):At.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):At.reject(e)}static resolve(t){return new At((e,n)=>{e(t)})}static reject(t){return new At((e,n)=>{n(t)})}static waitFor(t){return new At((e,n)=>{let r=0,i=0,s=!1;t.forEach(t=>{++r,t.next(()=>{++i,s&&i===r&&e()},t=>n(t))}),s=!0,i===r&&e()})}static or(t){let e=At.resolve(!1);for(const n of t)e=e.next(t=>t?At.resolve(t):n());return e}static forEach(t,e){const n=[];return t.forEach((t,r)=>{n.push(e.call(this,t,r))}),this.waitFor(n)}static mapArray(t,e){return new At((n,r)=>{const i=t.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;e(t[c]).next(t=>{s[c]=t,++o,o===i&&n(s)},t=>r(t))}})}static doWhile(t,e){return new At((n,r)=>{const i=()=>{!0===t()?e().next(()=>{i()},r):n()};i()})}}function It(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Dt(t){return"IndexedDbTransactionError"===t.name}class kt{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this._e(t),this.ae=t=>e.writeSequenceNumber(t))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}kt.ue=-1;const Nt=-1;function xt(t){return null==t}function Rt(t){return 0===t&&1/t==-1/0}const Ot="\x01";function Pt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Mt(e)),e=Lt(t.get(n),e);return Mt(e)}function Lt(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const e=t.charAt(i);switch(e){case"\0":n+="\x01\x10";break;case Ot:n+="\x01\x11";break;default:n+=e}}return n}function Mt(t){return t+Ot+"\x01"}const Ft="remoteDocuments",Vt="owner",Ut="mutationQueues",jt="mutations";const Bt="documentMutations",qt="remoteDocumentsV14",zt="remoteDocumentGlobal",Kt="targets",Ht="targetDocuments",Gt="targetGlobal",Wt="collectionParents",Qt="clientMetadata",Xt="bundles",Jt="namedQueries",Yt="indexConfiguration",$t="indexState",Zt="indexEntries",te="documentOverlays",ee="globals",ne=[Ut,jt,Bt,Ft,Kt,Vt,Gt,Ht,Qt,zt,Wt,Xt,Jt],re=[Ut,jt,Bt,qt,Kt,Vt,Gt,Ht,Qt,zt,Wt,Xt,Jt,te],ie=re,se=[...ie,Yt,$t,Zt];function oe(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ae(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function ce(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class le{constructor(t,e){this.comparator=t,this.root=e||he.EMPTY}insert(t,e){return new le(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,he.BLACK,null,null))}remove(t){return new le(this.comparator,this.root.remove(t,this.comparator).copy(null,null,he.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,n)=>(t(e,n),!1))}toString(){const t=[];return this.inorderTraversal((e,n)=>(t.push("".concat(e,":").concat(n)),!1)),"{".concat(t.join(", "),"}")}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ue(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ue(this.root,t,this.comparator,!1)}getReverseIterator(){return new ue(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ue(this.root,t,this.comparator,!0)}}class ue{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class he{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:he.RED,this.left=null!=r?r:he.EMPTY,this.right=null!=i?i:he.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new he(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return he.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return he.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,he.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,he.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw x(43730,{key:this.key,value:this.value});if(this.right.isRed())throw x(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw x(27949);return t+(this.isRed()?0:1)}}he.EMPTY=null,he.RED=!0,he.BLACK=!1,he.EMPTY=new class{constructor(){this.size=0}get key(){throw x(57766)}get value(){throw x(16141)}get color(){throw x(16727)}get left(){throw x(29726)}get right(){throw x(36894)}copy(t,e,n,r,i){return this}insert(t,e,n){return new he(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class de{constructor(t){this.comparator=t,this.data=new le(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,n)=>(t(e),!1))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new fe(this.data.getIterator())}getIteratorFrom(t){return new fe(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(t=>{e=e.add(t)}),e}isEqual(t){if(!(t instanceof de))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach(e=>{t.push(e)}),t}toString(){const t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){const e=new de(this.comparator);return e.data=t,e}}class fe{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class pe{constructor(t){this.fields=t,t.sort(it.comparator)}static empty(){return new pe([])}unionWith(t){let e=new de(it.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new pe(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return Z(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class ge extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class me{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new ge("Invalid base64 string: "+t):t}}(t);return new me(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new me(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return X(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}me.EMPTY_BYTE_STRING=new me("");const ye=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ve(t){if(O(!!t,39018),"string"==typeof t){let e=0;const n=ye.exec(t);if(O(!!n,46558,{timestamp:t}),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:we(t.seconds),nanos:we(t.nanos)}}function we(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function be(t){return"string"==typeof t?me.fromBase64String(t):me.fromUint8Array(t)}const Ee="server_timestamp",Te="__type__",_e="__previous_value__",Ce="__local_write_time__";function Se(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[Te])||void 0===n?void 0:n.stringValue)===Ee}function Ae(t){const e=t.mapValue.fields[_e];return Se(e)?Ae(e):e}function Ie(t){const e=ve(t.mapValue.fields[Ce].timestampValue);return new gt(e.seconds,e.nanos)}class De{constructor(t,e,n,r,i,s,o,a,c,l){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c,this.isUsingEmulator=l}}const ke="(default)";class Ne{constructor(t,e){this.projectId=t,this.database=e||ke}static empty(){return new Ne("","")}get isDefaultDatabase(){return this.database===ke}isEqual(t){return t instanceof Ne&&t.projectId===this.projectId&&t.database===this.database}}const xe="__type__",Re="__max__",Oe={mapValue:{fields:{__type__:{stringValue:Re}}}},Pe="__vector__",Le="value";function Me(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Se(t)?4:$e(t)?9007199254740991:Je(t)?10:11:x(28295,{value:t})}function Fe(t,e){if(t===e)return!0;const n=Me(t);if(n!==Me(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ie(t).isEqual(Ie(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=ve(t.timestampValue),r=ve(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return be(t.bytesValue).isEqual(be(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return we(t.geoPointValue.latitude)===we(e.geoPointValue.latitude)&&we(t.geoPointValue.longitude)===we(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return we(t.integerValue)===we(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=we(t.doubleValue),r=we(e.doubleValue);return n===r?Rt(n)===Rt(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Z(t.arrayValue.values||[],e.arrayValue.values||[],Fe);case 10:case 11:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(oe(n)!==oe(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Fe(n[i],r[i])))return!1;return!0}(t,e);default:return x(52216,{left:t})}}function Ve(t,e){return void 0!==(t.values||[]).find(t=>Fe(t,e))}function Ue(t,e){if(t===e)return 0;const n=Me(t),r=Me(e);if(n!==r)return X(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return X(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=we(t.integerValue||t.doubleValue),r=we(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return je(t.timestampValue,e.timestampValue);case 4:return je(Ie(t),Ie(e));case 5:return J(t.stringValue,e.stringValue);case 6:return function(t,e){const n=be(t),r=be(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let i=0;i<n.length&&i<r.length;i++){const t=X(n[i],r[i]);if(0!==t)return t}return X(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=X(we(t.latitude),we(e.latitude));return 0!==n?n:X(we(t.longitude),we(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Be(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n,r,i,s;const o=t.fields||{},a=e.fields||{},c=null===(n=o[Le])||void 0===n?void 0:n.arrayValue,l=null===(r=a[Le])||void 0===r?void 0:r.arrayValue,u=X((null===(i=null==c?void 0:c.values)||void 0===i?void 0:i.length)||0,(null===(s=null==l?void 0:l.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:Be(c,l)}(t.mapValue,e.mapValue);case 11:return function(t,e){if(t===Oe.mapValue&&e===Oe.mapValue)return 0;if(t===Oe.mapValue)return 1;if(e===Oe.mapValue)return-1;const n=t.fields||{},r=Object.keys(n),i=e.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const t=J(r[o],s[o]);if(0!==t)return t;const e=Ue(n[r[o]],i[s[o]]);if(0!==e)return e}return X(r.length,s.length)}(t.mapValue,e.mapValue);default:throw x(23264,{le:n})}}function je(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return X(t,e);const n=ve(t),r=ve(e),i=X(n.seconds,r.seconds);return 0!==i?i:X(n.nanos,r.nanos)}function Be(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const t=Ue(n[i],r[i]);if(t)return t}return X(n.length,r.length)}function qe(t){return ze(t)}function ze(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=ve(t);return"time(".concat(e.seconds,",").concat(e.nanos,")")}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(t){return be(t).toBase64()}(t.bytesValue):"referenceValue"in t?function(t){return st.fromName(t).toString()}(t.referenceValue):"geoPointValue"in t?function(t){return"geo(".concat(t.latitude,",").concat(t.longitude,")")}(t.geoPointValue):"arrayValue"in t?function(t){let e="[",n=!0;for(const r of t.values||[])n?n=!1:e+=",",e+=ze(r);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",r=!0;for(const i of e)r?r=!1:n+=",",n+="".concat(i,":").concat(ze(t.fields[i]));return n+"}"}(t.mapValue):x(61005,{value:t})}function Ke(t){switch(Me(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ae(t);return e?16+Ke(e):16;case 5:return 2*t.stringValue.length;case 6:return be(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(t){return(t.values||[]).reduce((t,e)=>t+Ke(e),0)}(t.arrayValue);case 10:case 11:return function(t){let e=0;return ae(t.fields,(t,n)=>{e+=t.length+Ke(n)}),e}(t.mapValue);default:throw x(13486,{value:t})}}function He(t){return!!t&&"integerValue"in t}function Ge(t){return!!t&&"arrayValue"in t}function We(t){return!!t&&"nullValue"in t}function Qe(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xe(t){return!!t&&"mapValue"in t}function Je(t){var e,n;return(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{})[xe])||void 0===n?void 0:n.stringValue)===Pe}function Ye(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ae(t.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Ye(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ye(t.arrayValue.values[n]);return e}return Object.assign({},t)}function $e(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Re}class Ze{constructor(t){this.value=t}static empty(){return new Ze({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Xe(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Ye(e)}setAll(t){let e=it.emptyPath(),n={},r=[];t.forEach((t,i)=>{if(!e.isImmediateParentOf(i)){const t=this.getFieldsMap(e);this.applyChanges(t,n,r),n={},r=[],e=i.popLast()}t?n[i.lastSegment()]=Ye(t):r.push(i.lastSegment())});const i=this.getFieldsMap(e);this.applyChanges(i,n,r)}delete(t){const e=this.field(t.popLast());Xe(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Fe(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let r=e.mapValue.fields[t.get(n)];Xe(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,n){ae(e,(e,n)=>t[e]=n);for(const r of n)delete t[r]}clone(){return new Ze(Ye(this.value))}}class tn{constructor(t,e,n,r,i,s,o){this.key=t,this.documentType=e,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(t){return new tn(t,0,mt.min(),mt.min(),mt.min(),Ze.empty(),0)}static newFoundDocument(t,e,n,r){return new tn(t,1,e,mt.min(),n,r,0)}static newNoDocument(t,e){return new tn(t,2,e,mt.min(),mt.min(),Ze.empty(),0)}static newUnknownDocument(t,e){return new tn(t,3,e,mt.min(),mt.min(),Ze.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(mt.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ze.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mt.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof tn&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new tn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class en{constructor(t,e){this.position=t,this.inclusive=e}}function nn(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(r=s.field.isKeyField()?st.comparator(st.fromName(o.referenceValue),n.key):Ue(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function rn(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fe(t.position[n],e.position[n]))return!1;return!0}class sn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=t,this.dir=e}}function on(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class an{}class cn extends an{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.createKeyFieldInFilter(t,e,n):new mn(t,e,n):"array-contains"===e?new bn(t,n):"in"===e?new En(t,n):"not-in"===e?new Tn(t,n):"array-contains-any"===e?new _n(t,n):new cn(t,e,n)}static createKeyFieldInFilter(t,e,n){return"in"===e?new yn(t,n):new vn(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&void 0===e.nullValue&&this.matchesComparison(Ue(e,this.value)):null!==e&&Me(this.value)===Me(e)&&this.matchesComparison(Ue(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return x(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ln extends an{constructor(t,e){super(),this.filters=t,this.op=e,this.he=null}static create(t,e){return new ln(t,e)}matches(t){return un(this)?void 0===this.filters.find(e=>!e.matches(t)):void 0!==this.filters.find(e=>e.matches(t))}getFlattenedFilters(){return null!==this.he||(this.he=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function un(t){return"and"===t.op}function hn(t){return dn(t)&&un(t)}function dn(t){for(const e of t.filters)if(e instanceof ln)return!1;return!0}function fn(t){if(t instanceof cn)return t.field.canonicalString()+t.op.toString()+qe(t.value);if(hn(t))return t.filters.map(t=>fn(t)).join(",");{const e=t.filters.map(t=>fn(t)).join(",");return"".concat(t.op,"(").concat(e,")")}}function pn(t,e){return t instanceof cn?function(t,e){return e instanceof cn&&t.op===e.op&&t.field.isEqual(e.field)&&Fe(t.value,e.value)}(t,e):t instanceof ln?function(t,e){return e instanceof ln&&t.op===e.op&&t.filters.length===e.filters.length&&t.filters.reduce((t,n,r)=>t&&pn(n,e.filters[r]),!0)}(t,e):void x(19439)}function gn(t){return t instanceof cn?function(t){return"".concat(t.field.canonicalString()," ").concat(t.op," ").concat(qe(t.value))}(t):t instanceof ln?function(t){return t.op.toString()+" {"+t.getFilters().map(gn).join(" ,")+"}"}(t):"Filter"}class mn extends cn{constructor(t,e,n){super(t,e,n),this.key=st.fromName(n.referenceValue)}matches(t){const e=st.comparator(t.key,this.key);return this.matchesComparison(e)}}class yn extends cn{constructor(t,e){super(t,"in",e),this.keys=wn("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class vn extends cn{constructor(t,e){super(t,"not-in",e),this.keys=wn("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function wn(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>st.fromName(t.referenceValue))}class bn extends cn{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Ge(e)&&Ve(e.arrayValue,this.value)}}class En extends cn{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Ve(this.value.arrayValue,e)}}class Tn extends cn{constructor(t,e){super(t,"not-in",e)}matches(t){if(Ve(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&void 0===e.nullValue&&!Ve(this.value.arrayValue,e)}}class _n extends cn{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Ge(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>Ve(this.value.arrayValue,t))}}class Cn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Pe=null}}function Sn(t){return new Cn(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function An(t){const e=P(t);if(null===e.Pe){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(t=>fn(t)).join(","),t+="|ob:",t+=e.orderBy.map(t=>function(t){return t.field.canonicalString()+t.dir}(t)).join(","),xt(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(t=>qe(t)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(t=>qe(t)).join(",")),e.Pe=t}return e.Pe}function In(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!on(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!pn(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!rn(t.startAt,e.startAt)&&rn(t.endAt,e.endAt)}function Dn(t){return st.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class kn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function Nn(t,e,n,r,i,s,o,a){return new kn(t,e,n,r,i,s,o,a)}function xn(t){return new kn(t)}function Rn(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}function On(t){return null!==t.collectionGroup}function Pn(t){const e=P(t);if(null===e.Te){e.Te=[];const t=new Set;for(const i of e.explicitOrderBy)e.Te.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",r=function(t){let e=new de(it.comparator);return t.filters.forEach(t=>{t.getFlattenedFilters().forEach(t=>{t.isInequality()&&(e=e.add(t.field))})}),e}(e);r.forEach(r=>{t.has(r.canonicalString())||r.isKeyField()||e.Te.push(new sn(r,n))}),t.has(it.keyField().canonicalString())||e.Te.push(new sn(it.keyField(),n))}return e.Te}function Ln(t){const e=P(t);return e.Ie||(e.Ie=Mn(e,Pn(t))),e.Ie}function Mn(t,e){if("F"===t.limitType)return Sn(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(t=>{const e="desc"===t.dir?"asc":"desc";return new sn(t.field,e)});const n=t.endAt?new en(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new en(t.startAt.position,t.startAt.inclusive):null;return Sn(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Fn(t,e,n){return new kn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Vn(t,e){return In(Ln(t),Ln(e))&&t.limitType===e.limitType}function Un(t){return"".concat(An(Ln(t)),"|lt:").concat(t.limitType)}function jn(t){return"Query(target=".concat(function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: [".concat(t.filters.map(t=>gn(t)).join(", "),"]")),xt(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: [".concat(t.orderBy.map(t=>function(t){return"".concat(t.field.canonicalString()," (").concat(t.dir,")")}(t)).join(", "),"]")),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(t=>qe(t)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(t=>qe(t)).join(",")),"Target(".concat(e,")")}(Ln(t)),"; limitType=").concat(t.limitType,")")}function Bn(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):st.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of Pn(t))if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const r=nn(t,e,n);return t.inclusive?r<=0:r<0}(t.startAt,Pn(t),e))&&!(t.endAt&&!function(t,e,n){const r=nn(t,e,n);return t.inclusive?r>=0:r>0}(t.endAt,Pn(t),e))}(t,e)}function qn(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function zn(t){return(e,n)=>{let r=!1;for(const i of Pn(t)){const t=Kn(i,e,n);if(0!==t)return t;r=r||i.field.isKeyField()}return 0}}function Kn(t,e,n){const r=t.field.isKeyField()?st.comparator(e.key,n.key):function(t,e,n){const r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?Ue(r,i):x(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return x(19790,{direction:t.dir})}}class Hn{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,t))return i}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return this.inner[n]=[[t,e]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(t){ae(this.inner,(e,n)=>{for(const[r,i]of n)t(r,i)})}isEmpty(){return ce(this.inner)}size(){return this.innerSize}}const Gn=new le(st.comparator);function Wn(){return Gn}const Qn=new le(st.comparator);function Xn(){let t=Qn;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)t=t.insert(i.key,i);return t}function Jn(t){let e=Qn;return t.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Yn(){return Zn()}function $n(){return Zn()}function Zn(){return new Hn(t=>t.toString(),(t,e)=>t.isEqual(e))}new le(st.comparator);const tr=new de(st.comparator);function er(){let t=tr;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)t=t.add(i);return t}const nr=new de(X);function rr(){return nr}function ir(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rt(e)?"-0":e}}function sr(t){return{integerValue:""+t}}class or{constructor(){this._=void 0}}function ar(t,e,n){return t instanceof ur?function(t,e){const n={fields:{[Te]:{stringValue:Ee},[Ce]:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&Se(e)&&(e=Ae(e)),e&&(n.fields[_e]=e),{mapValue:n}}(n,e):t instanceof hr?dr(t,e):t instanceof fr?pr(t,e):function(t,e){const n=lr(t,e),r=mr(n)+mr(t.Ee);return He(n)&&He(t.Ee)?sr(r):ir(t.serializer,r)}(t,e)}function cr(t,e,n){return t instanceof hr?dr(t,e):t instanceof fr?pr(t,e):n}function lr(t,e){return t instanceof gr?function(t){return He(t)||function(t){return!!t&&"doubleValue"in t}(t)}(e)?e:{integerValue:0}:null}class ur extends or{}class hr extends or{constructor(t){super(),this.elements=t}}function dr(t,e){const n=yr(e);for(const r of t.elements)n.some(t=>Fe(t,r))||n.push(r);return{arrayValue:{values:n}}}class fr extends or{constructor(t){super(),this.elements=t}}function pr(t,e){let n=yr(e);for(const r of t.elements)n=n.filter(t=>!Fe(t,r));return{arrayValue:{values:n}}}class gr extends or{constructor(t,e){super(),this.serializer=t,this.Ee=e}}function mr(t){return we(t.integerValue||t.doubleValue)}function yr(t){return Ge(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class vr{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new vr}static exists(t){return new vr(void 0,t)}static updateTime(t){return new vr(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function wr(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class br{}function Er(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new Nr(t.key,vr.none()):new Sr(t.key,t.data,vr.none());{const n=t.data,r=Ze.empty();let i=new de(it.comparator);for(let t of e.fields)if(!i.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?r.delete(t):r.set(t,e),i=i.add(t)}return new Ar(t.key,r,new pe(i.toArray()),vr.none())}}function Tr(t,e,n){t instanceof Sr?function(t,e,n){const r=t.value.clone(),i=Dr(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Ar?function(t,e,n){if(!wr(t.precondition,e))return void e.convertToUnknownDocument(n.version);const r=Dr(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(Ir(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function _r(t,e,n,r){return t instanceof Sr?function(t,e,n,r){if(!wr(t.precondition,e))return n;const i=t.value.clone(),s=kr(t.fieldTransforms,r,e);return i.setAll(s),e.convertToFoundDocument(e.version,i).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ar?function(t,e,n,r){if(!wr(t.precondition,e))return n;const i=kr(t.fieldTransforms,r,e),s=e.data;return s.setAll(Ir(t)),s.setAll(i),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map(t=>t.field))}(t,e,n,r):function(t,e,n){return wr(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Cr(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Z(t,e,(t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof hr&&e instanceof hr||t instanceof fr&&e instanceof fr?Z(t.elements,e.elements,Fe):t instanceof gr&&e instanceof gr?Fe(t.Ee,e.Ee):t instanceof ur&&e instanceof ur}(t.transform,e.transform)}(t,e))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Sr extends br{constructor(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ar extends br{constructor(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ir(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Dr(t,e,n){const r=new Map;O(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,cr(o,a,n[i]))}return r}function kr(t,e,n){const r=new Map;for(const i of t){const t=i.transform,s=n.data.field(i.field);r.set(i.field,ar(t,s,e))}return r}class Nr extends br{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xr{constructor(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let r=0;r<this.mutations.length;r++){const e=this.mutations[r];e.key.isEqual(t.key)&&Tr(e,t,n[r])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=_r(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=_r(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=$n();return this.mutations.forEach(r=>{const i=t.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=e.has(r.key)?null:o;const a=Er(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(mt.min())}),n}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),er())}isEqual(t){return this.batchId===t.batchId&&Z(this.mutations,t.mutations,(t,e)=>Cr(t,e))&&Z(this.baseMutations,t.baseMutations,(t,e)=>Cr(t,e))}}class Rr{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Or{constructor(t,e){this.count=t,this.unchangedNames=e}}var Pr,Lr;function Mr(t){if(void 0===t)return D("GRPC error has no .code"),L.UNKNOWN;switch(t){case Pr.OK:return L.OK;case Pr.CANCELLED:return L.CANCELLED;case Pr.UNKNOWN:return L.UNKNOWN;case Pr.DEADLINE_EXCEEDED:return L.DEADLINE_EXCEEDED;case Pr.RESOURCE_EXHAUSTED:return L.RESOURCE_EXHAUSTED;case Pr.INTERNAL:return L.INTERNAL;case Pr.UNAVAILABLE:return L.UNAVAILABLE;case Pr.UNAUTHENTICATED:return L.UNAUTHENTICATED;case Pr.INVALID_ARGUMENT:return L.INVALID_ARGUMENT;case Pr.NOT_FOUND:return L.NOT_FOUND;case Pr.ALREADY_EXISTS:return L.ALREADY_EXISTS;case Pr.PERMISSION_DENIED:return L.PERMISSION_DENIED;case Pr.FAILED_PRECONDITION:return L.FAILED_PRECONDITION;case Pr.ABORTED:return L.ABORTED;case Pr.OUT_OF_RANGE:return L.OUT_OF_RANGE;case Pr.UNIMPLEMENTED:return L.UNIMPLEMENTED;case Pr.DATA_LOSS:return L.DATA_LOSS;default:return x(39323,{code:t})}}(Lr=Pr||(Pr={}))[Lr.OK=0]="OK",Lr[Lr.CANCELLED=1]="CANCELLED",Lr[Lr.UNKNOWN=2]="UNKNOWN",Lr[Lr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Lr[Lr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Lr[Lr.NOT_FOUND=5]="NOT_FOUND",Lr[Lr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Lr[Lr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Lr[Lr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Lr[Lr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Lr[Lr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Lr[Lr.ABORTED=10]="ABORTED",Lr[Lr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Lr[Lr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Lr[Lr.INTERNAL=13]="INTERNAL",Lr[Lr.UNAVAILABLE=14]="UNAVAILABLE",Lr[Lr.DATA_LOSS=15]="DATA_LOSS";let Fr=null;const Vr=new r([4294967295,4294967295],0);function Ur(t){const e=W().encode(t),n=new i;return n.update(e),new Uint8Array(n.digest())}function jr(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new r([n,i],0),new r([s,o],0)]}class Br{constructor(t,e,n){if(this.bitmap=t,this.padding=e,this.hashCount=n,e<0||e>=8)throw new qr("Invalid padding: ".concat(e));if(n<0)throw new qr("Invalid hash count: ".concat(n));if(t.length>0&&0===this.hashCount)throw new qr("Invalid hash count: ".concat(n));if(0===t.length&&0!==e)throw new qr("Invalid padding when bitmap length is 0: ".concat(e));this.fe=8*t.length-e,this.ge=r.fromNumber(this.fe)}pe(t,e,n){let i=t.add(e.multiply(r.fromNumber(n)));return 1===i.compare(Vr)&&(i=new r([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(0===this.fe)return!1;const e=Ur(t),[n,r]=jr(e);for(let i=0;i<this.hashCount;i++){const t=this.pe(n,r,i);if(!this.ye(t))return!1}return!0}static create(t,e,n){const r=t%8==0?0:8-t%8,i=new Uint8Array(Math.ceil(t/8)),s=new Br(i,r,e);return n.forEach(t=>s.insert(t)),s}insert(t){if(0===this.fe)return;const e=Ur(t),[n,r]=jr(e);for(let i=0;i<this.hashCount;i++){const t=this.pe(n,r,i);this.we(t)}}we(t){const e=Math.floor(t/8),n=t%8;this.bitmap[e]|=1<<n}}class qr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class zr{constructor(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,e,n){const r=new Map;return r.set(t,Kr.createSynthesizedTargetChangeForCurrentChange(t,e,n)),new zr(mt.min(),r,new le(X),Wn(),er())}}class Kr{constructor(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,e,n){return new Kr(n,e,er(),er(),er())}}class Hr{constructor(t,e,n,r){this.Se=t,this.removedTargetIds=e,this.key=n,this.be=r}}class Gr{constructor(t,e){this.targetId=t,this.De=e}}class Wr{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:me.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}}class Qr{constructor(){this.ve=0,this.Ce=Yr(),this.Fe=me.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return 0!==this.ve}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=er(),e=er(),n=er();return this.Ce.forEach((r,i)=>{switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:x(38017,{changeType:i})}}),new Kr(this.Fe,this.Me,t,e,n)}ke(){this.xe=!1,this.Ce=Yr()}qe(t,e){this.xe=!0,this.Ce=this.Ce.insert(t,e)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,O(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class Xr{constructor(t){this.We=t,this.Ge=new Map,this.ze=Wn(),this.je=Jr(),this.Je=Jr(),this.He=new le(X)}Ye(t){for(const e of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(e,t.be):this.Xe(e,t.key,t.be);for(const e of t.removedTargetIds)this.Xe(e,t.key,t.be)}et(t){this.forEachTarget(t,e=>{const n=this.tt(e);switch(t.state){case 0:this.nt(e)&&n.Be(t.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(t.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(e);break;case 3:this.nt(e)&&(n.Ke(),n.Be(t.resumeToken));break;case 4:this.nt(e)&&(this.rt(e),n.Be(t.resumeToken));break;default:x(56790,{state:t.state})}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Ge.forEach((t,n)=>{this.nt(n)&&e(n)})}it(t){const e=t.targetId,n=t.De.count,r=this.st(e);if(r){const i=r.target;if(Dn(i))if(0===n){const t=new st(i.path);this.Xe(e,t,tn.newNoDocument(t,mt.min()))}else O(1===n,20013,{expectedCount:n});else{const r=this.ot(e);if(r!==n){const n=this._t(t),i=n?this.ut(n,t,r):1;if(0!==i){this.rt(e);const t=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(e,t)}null==Fr||Fr.ct(function(t,e,n,r,i){var s,o,a,c,l,u;const h={localCacheCount:t,existenceFilterCount:e.count,databaseId:n.database,projectId:n.projectId},d=e.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(c=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==c?c:0,padding:null!==(u=null===(l=null==d?void 0:d.bits)||void 0===l?void 0:l.padding)&&void 0!==u?u:0,mightContain:t=>{var e;return null!==(e=null==r?void 0:r.mightContain(t))&&void 0!==e&&e}}),h}(r,t.De,this.We.lt(),n,i))}}}}_t(t){const e=t.De.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=e;let s,o;try{s=be(n).toUint8Array()}catch(t){if(t instanceof ge)return k("Decoding the base64 bloom filter in existence filter failed ("+t.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw t}try{o=new Br(s,r,i)}catch(t){return k(t instanceof qr?"BloomFilter error: ":"Applying bloom filter failed: ",t),null}return 0===o.fe?null:o}ut(t,e,n){return e.De.count===n-this.ht(t,e.targetId)?0:2}ht(t,e){const n=this.We.getRemoteKeysForTarget(e);let r=0;return n.forEach(n=>{const i=this.We.lt(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());t.mightContain(s)||(this.Xe(e,n,null),r++)}),r}Pt(t){const e=new Map;this.Ge.forEach((n,r)=>{const i=this.st(r);if(i){if(n.current&&Dn(i.target)){const e=new st(i.target.path);this.Tt(e).has(r)||this.It(r,e)||this.Xe(r,e,tn.newNoDocument(e,t))}n.Ne&&(e.set(r,n.Le()),n.ke())}});let n=er();this.Je.forEach((t,e)=>{let r=!0;e.forEachWhile(t=>{const e=this.st(t);return!e||"TargetPurposeLimboResolution"===e.purpose||(r=!1,!1)}),r&&(n=n.add(t))}),this.ze.forEach((e,n)=>n.setReadTime(t));const r=new zr(t,e,this.He,this.ze,n);return this.ze=Wn(),this.je=Jr(),this.Je=Jr(),this.He=new le(X),r}Ze(t,e){if(!this.nt(t))return;const n=this.It(t,e.key)?2:0;this.tt(t).qe(e.key,n),this.ze=this.ze.insert(e.key,e),this.je=this.je.insert(e.key,this.Tt(e.key).add(t)),this.Je=this.Je.insert(e.key,this.dt(e.key).add(t))}Xe(t,e,n){if(!this.nt(t))return;const r=this.tt(t);this.It(t,e)?r.qe(e,1):r.Qe(e),this.Je=this.Je.insert(e,this.dt(e).delete(t)),this.Je=this.Je.insert(e,this.dt(e).add(t)),n&&(this.ze=this.ze.insert(e,n))}removeTarget(t){this.Ge.delete(t)}ot(t){const e=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let e=this.Ge.get(t);return e||(e=new Qr,this.Ge.set(t,e)),e}dt(t){let e=this.Je.get(t);return e||(e=new de(X),this.Je=this.Je.insert(t,e)),e}Tt(t){let e=this.je.get(t);return e||(e=new de(X),this.je=this.je.insert(t,e)),e}nt(t){const e=null!==this.st(t);return e||I("WatchChangeAggregator","Detected inactive target",t),e}st(t){const e=this.Ge.get(t);return e&&e.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new Qr),this.We.getRemoteKeysForTarget(t).forEach(e=>{this.Xe(t,e,null)})}It(t,e){return this.We.getRemoteKeysForTarget(t).has(e)}}function Jr(){return new le(st.comparator)}function Yr(){return new le(st.comparator)}const $r={asc:"ASCENDING",desc:"DESCENDING"},Zr={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ti={and:"AND",or:"OR"};class ei{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function ni(t,e){return t.useProto3Json||xt(e)?e:{value:e}}function ri(t,e){return t.useProto3Json?"".concat(new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+e.nanoseconds).slice(-9),"Z"):{seconds:""+e.seconds,nanos:e.nanoseconds}}function ii(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function si(t){return O(!!t,49232),mt.fromTimestamp(function(t){const e=ve(t);return new gt(e.seconds,e.nanos)}(t))}function oi(t,e){return ai(t,e).canonicalString()}function ai(t,e){const n=function(t){return new nt(["projects",t.projectId,"databases",t.database])}(t).child("documents");return void 0===e?n:n.child(e)}function ci(t){const e=nt.fromString(t);return O(Ci(e),10190,{key:e.toString()}),e}function li(t,e){const n=ci(e);if(n.get(1)!==t.databaseId.projectId)throw new M(L.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new M(L.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new st(fi(n))}function ui(t,e){return oi(t.databaseId,e)}function hi(t){const e=ci(t);return 4===e.length?nt.emptyPath():fi(e)}function di(t){return new nt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fi(t){return O(t.length>4&&"documents"===t.get(4),29091,{key:t.toString()}),t.popFirst(5)}function pi(t,e){return{documents:[ui(t,e.path)]}}function gi(t,e){const n={structuredQuery:{}},r=e.path;let i;null!==e.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ui(t,i);const s=function(t){if(0!==t.length)return _i(ln.create(t,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(t){if(0!==t.length)return t.map(t=>function(t){return{field:Ei(t.field),direction:vi(t.dir)}}(t))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=ni(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(t){return{before:t.inclusive,values:t.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),{Vt:n,parent:i}}function mi(t){let e=hi(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){O(1===r,65062);const t=n.from[0];t.allDescendants?i=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=function(t){const e=yi(t);return e instanceof ln&&hn(e)?e.getFilters():[e]}(n.where));let o=[];n.orderBy&&(o=function(t){return t.map(t=>function(t){return new sn(Ti(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))}(n.orderBy));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,xt(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new en(n,e)}(n.startAt));let l=null;return n.endAt&&(l=function(t){const e=!t.before,n=t.values||[];return new en(n,e)}(n.endAt)),Nn(e,i,o,s,a,"F",c,l)}function yi(t){return void 0!==t.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Ti(t.unaryFilter.field);return cn.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Ti(t.unaryFilter.field);return cn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ti(t.unaryFilter.field);return cn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ti(t.unaryFilter.field);return cn.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return x(61313);default:return x(60726)}}(t):void 0!==t.fieldFilter?function(t){return cn.create(Ti(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return x(58110);default:return x(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(t):void 0!==t.compositeFilter?function(t){return ln.create(t.compositeFilter.filters.map(t=>yi(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return x(1026)}}(t.compositeFilter.op))}(t):x(30097,{filter:t})}function vi(t){return $r[t]}function wi(t){return Zr[t]}function bi(t){return ti[t]}function Ei(t){return{fieldPath:t.canonicalString()}}function Ti(t){return it.fromServerFormat(t.fieldPath)}function _i(t){return t instanceof cn?function(t){if("=="===t.op){if(Qe(t.value))return{unaryFilter:{field:Ei(t.field),op:"IS_NAN"}};if(We(t.value))return{unaryFilter:{field:Ei(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Qe(t.value))return{unaryFilter:{field:Ei(t.field),op:"IS_NOT_NAN"}};if(We(t.value))return{unaryFilter:{field:Ei(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ei(t.field),op:wi(t.op),value:t.value}}}(t):t instanceof ln?function(t){const e=t.getFilters().map(t=>_i(t));return 1===e.length?e[0]:{compositeFilter:{op:bi(t.op),filters:e}}}(t):x(54877,{filter:t})}function Ci(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class Si{constructor(t,e,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:mt.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:mt.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:me.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(t){return new Si(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Si(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Ai{constructor(t){this.gt=t}}function Ii(t){const e=mi({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Fn(e,e.limit,"L"):e}class Di{constructor(){}bt(t,e){this.Dt(t,e),e.vt()}Dt(t,e){if("nullValue"in t)this.Ct(e,5);else if("booleanValue"in t)this.Ct(e,10),e.Ft(t.booleanValue?1:0);else if("integerValue"in t)this.Ct(e,15),e.Ft(we(t.integerValue));else if("doubleValue"in t){const n=we(t.doubleValue);isNaN(n)?this.Ct(e,13):(this.Ct(e,15),Rt(n)?e.Ft(0):e.Ft(n))}else if("timestampValue"in t){let n=t.timestampValue;this.Ct(e,20),"string"==typeof n&&(n=ve(n)),e.Mt("".concat(n.seconds||"")),e.Ft(n.nanos||0)}else if("stringValue"in t)this.xt(t.stringValue,e),this.Ot(e);else if("bytesValue"in t)this.Ct(e,30),e.Nt(be(t.bytesValue)),this.Ot(e);else if("referenceValue"in t)this.Bt(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.Ct(e,45),e.Ft(n.latitude||0),e.Ft(n.longitude||0)}else"mapValue"in t?$e(t)?this.Ct(e,Number.MAX_SAFE_INTEGER):Je(t)?this.Lt(t.mapValue,e):(this.kt(t.mapValue,e),this.Ot(e)):"arrayValue"in t?(this.qt(t.arrayValue,e),this.Ot(e)):x(19022,{Qt:t})}xt(t,e){this.Ct(e,25),this.$t(t,e)}$t(t,e){e.Mt(t)}kt(t,e){const n=t.fields||{};this.Ct(e,55);for(const r of Object.keys(n))this.xt(r,e),this.Dt(n[r],e)}Lt(t,e){var n,r;const i=t.fields||{};this.Ct(e,53);const s=Le,o=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.Ct(e,15),e.Ft(we(o)),this.xt(s,e),this.Dt(i[s],e)}qt(t,e){const n=t.values||[];this.Ct(e,50);for(const r of n)this.Dt(r,e)}Bt(t,e){this.Ct(e,37),st.fromName(t).path.forEach(t=>{this.Ct(e,60),this.$t(t,e)})}Ct(t,e){t.Ft(e)}Ot(t){t.Ft(2)}}Di.Ut=new Di;class ki{constructor(){this.Dn=new Ni}addToCollectionParentIndex(t,e){return this.Dn.add(e),At.resolve()}getCollectionParents(t,e){return At.resolve(this.Dn.getEntries(e))}addFieldIndex(t,e){return At.resolve()}deleteFieldIndex(t,e){return At.resolve()}deleteAllFieldIndexes(t){return At.resolve()}createTargetIndexes(t,e){return At.resolve()}getDocumentsMatchingTarget(t,e){return At.resolve(null)}getIndexType(t,e){return At.resolve(0)}getFieldIndexes(t,e){return At.resolve([])}getNextCollectionGroupToUpdate(t){return At.resolve(null)}getMinOffset(t,e){return At.resolve(Et.min())}getMinOffsetFromCollectionGroup(t,e){return At.resolve(Et.min())}updateCollectionGroup(t,e,n){return At.resolve()}updateIndexEntries(t,e){return At.resolve()}}class Ni{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new de(nt.comparator),i=!r.has(n);return this.index[e]=r.add(n),i}has(t){const e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)}getEntries(t){return(this.index[t]||new de(nt.comparator)).toArray()}}new Uint8Array(0);const xi={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ri=41943040;class Oi{static withCacheSize(t){return new Oi(t,Oi.DEFAULT_COLLECTION_PERCENTILE,Oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}}Oi.DEFAULT_COLLECTION_PERCENTILE=10,Oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Oi.DEFAULT=new Oi(Ri,Oi.DEFAULT_COLLECTION_PERCENTILE,Oi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Oi.DISABLED=new Oi(-1,0,0);class Pi{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new Pi(0)}static ur(){return new Pi(-1)}}const Li="LruGarbageCollector",Mi=1048576;function Fi(t,e){let[n,r]=t,[i,s]=e;const o=X(n,i);return 0===o?X(r,s):o}class Vi{constructor(t){this.Tr=t,this.buffer=new de(Fi),this.Ir=0}dr(){return++this.Ir}Er(t){const e=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(e);else{const t=this.buffer.last();Fi(e,t)<0&&(this.buffer=this.buffer.delete(t).add(e))}}get maxValue(){return this.buffer.last()[0]}}class Ui{constructor(t,e,n){this.garbageCollector=t,this.asyncQueue=e,this.localStore=n,this.Ar=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return null!==this.Ar}Rr(t){I(Li,"Garbage collection scheduled in ".concat(t,"ms")),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Dt(t)?I(Li,"Ignoring IndexedDB error during garbage collection: ",t):await St(t)}await this.Rr(3e5)})}}class ji{constructor(t,e){this.Vr=t,this.params=e}calculateTargetCount(t,e){return this.Vr.mr(t).next(t=>Math.floor(e/100*t))}nthSequenceNumber(t,e){if(0===e)return At.resolve(kt.ue);const n=new Vi(e);return this.Vr.forEachTarget(t,t=>n.Er(t.sequenceNumber)).next(()=>this.Vr.gr(t,t=>n.Er(t))).next(()=>n.maxValue)}removeTargets(t,e,n){return this.Vr.removeTargets(t,e,n)}removeOrphanedDocuments(t,e){return this.Vr.removeOrphanedDocuments(t,e)}collect(t,e){return-1===this.params.cacheSizeCollectionThreshold?(I("LruGarbageCollector","Garbage collection skipped; disabled"),At.resolve(xi)):this.getCacheSize(t).next(n=>n<this.params.cacheSizeCollectionThreshold?(I("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),xi):this.pr(t,e))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,e){let n,r,i,s,o,c,l;const u=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(e=>(e>this.params.maximumSequenceNumbersToCollect?(I("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(e)),r=this.params.maximumSequenceNumbersToCollect):r=e,s=Date.now(),this.nthSequenceNumber(t,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(t,n,e))).next(e=>(i=e,c=Date.now(),this.removeOrphanedDocuments(t,n))).next(t=>(l=Date.now(),A()<=a.$b.DEBUG&&I("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-u,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-s)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(c-o)+"ms\n"+"\tRemoved ".concat(t," documents in ")+(l-c)+"ms\n"+"Total Duration: ".concat(l-u,"ms")),At.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})))}}function Bi(t,e){return new ji(t,e)}class qi{constructor(){this.changes=new Hn(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,tn.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?At.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class zi{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class Ki{constructor(t,e,n,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=r}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next(r=>(n=r,this.remoteDocumentCache.getEntry(t,e))).next(t=>(null!==n&&_r(n.mutation,t,pe.empty(),gt.now()),t))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.getLocalViewOfDocuments(t,e,er()).next(()=>e))}getLocalViewOfDocuments(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:er();const r=Yn();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,n).next(t=>{let e=Xn();return t.forEach((t,n)=>{e=e.insert(t,n.overlayedDocument)}),e}))}getOverlayedDocuments(t,e){const n=Yn();return this.populateOverlays(t,n,e).next(()=>this.computeViews(t,e,n,er()))}populateOverlays(t,e,n){const r=[];return n.forEach(t=>{e.has(t)||r.push(t)}),this.documentOverlayCache.getOverlays(t,r).next(t=>{t.forEach((t,n)=>{e.set(t,n)})})}computeViews(t,e,n,r){let i=Wn();const s=Zn(),o=Zn();return e.forEach((t,e)=>{const o=n.get(e.key);r.has(e.key)&&(void 0===o||o.mutation instanceof Ar)?i=i.insert(e.key,e):void 0!==o?(s.set(e.key,o.mutation.getFieldMask()),_r(o.mutation,e,o.mutation.getFieldMask(),gt.now())):s.set(e.key,pe.empty())}),this.recalculateAndSaveOverlays(t,i).next(t=>(t.forEach((t,e)=>s.set(t,e)),e.forEach((t,e)=>{var n;return o.set(t,new zi(e,null!==(n=s.get(t))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(t,e){const n=Zn();let r=new le((t,e)=>t-e),i=er();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(t=>{for(const i of t)i.keys().forEach(t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||pe.empty();o=i.applyToLocalView(s,o),n.set(t,o);const a=(r.get(i.batchId)||er()).add(t);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,l=$n();c.forEach(t=>{if(!i.has(t)){const r=Er(e.get(t),n.get(t));null!==r&&l.set(t,r),i=i.add(t)}}),s.push(this.documentOverlayCache.saveOverlays(t,a,l))}return At.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(e=>this.recalculateAndSaveOverlays(t,e))}getDocumentsMatchingQuery(t,e,n,r){return function(t){return st.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):On(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n,r):this.getDocumentsMatchingCollectionQuery(t,e,n,r)}getNextDocuments(t,e,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,r-i.size):At.resolve(Yn());let o=yt,a=i;return s.next(e=>At.forEach(e,(e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(e)?At.resolve():this.remoteDocumentCache.getEntry(t,e).next(t=>{a=a.insert(e,t)}))).next(()=>this.populateOverlays(t,e,i)).next(()=>this.computeViews(t,a,e,er())).next(t=>({batchId:o,changes:Jn(t)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new st(e)).next(t=>{let e=Xn();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e})}getDocumentsMatchingCollectionGroupQuery(t,e,n,r){const i=e.collectionGroup;let s=Xn();return this.indexManager.getCollectionParents(t,i).next(o=>At.forEach(o,o=>{const a=function(t,e){return new kn(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,o.child(i));return this.getDocumentsMatchingCollectionQuery(t,a,n,r).next(t=>{t.forEach((t,e)=>{s=s.insert(t,e)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(t,e,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,n,i,r))).next(t=>{i.forEach((e,n)=>{const r=n.getKey();null===t.get(r)&&(t=t.insert(r,tn.newInvalidDocument(r)))});let n=Xn();return t.forEach((t,r)=>{const s=i.get(t);void 0!==s&&_r(s.mutation,r,pe.empty(),gt.now()),Bn(e,r)&&(n=n.insert(t,r))}),n})}}class Hi{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,e){return At.resolve(this.Br.get(e))}saveBundleMetadata(t,e){return this.Br.set(e.id,function(t){return{id:t.id,version:t.version,createTime:si(t.createTime)}}(e)),At.resolve()}getNamedQuery(t,e){return At.resolve(this.Lr.get(e))}saveNamedQuery(t,e){return this.Lr.set(e.name,function(t){return{name:t.name,query:Ii(t.bundledQuery),readTime:si(t.readTime)}}(e)),At.resolve()}}class Gi{constructor(){this.overlays=new le(st.comparator),this.kr=new Map}getOverlay(t,e){return At.resolve(this.overlays.get(e))}getOverlays(t,e){const n=Yn();return At.forEach(e,e=>this.getOverlay(t,e).next(t=>{null!==t&&n.set(e,t)})).next(()=>n)}saveOverlays(t,e,n){return n.forEach((n,r)=>{this.wt(t,e,r)}),At.resolve()}removeOverlaysForBatchId(t,e,n){const r=this.kr.get(n);return void 0!==r&&(r.forEach(t=>this.overlays=this.overlays.remove(t)),this.kr.delete(n)),At.resolve()}getOverlaysForCollection(t,e,n){const r=Yn(),i=e.length+1,s=new st(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===i&&t.largestBatchId>n&&r.set(t.getKey(),t)}return At.resolve(r)}getOverlaysForCollectionGroup(t,e,n,r){let i=new le((t,e)=>t-e);const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=i.get(t.largestBatchId);null===e&&(e=Yn(),i=i.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=Yn(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((t,e)=>o.set(t,e)),!(o.size()>=r)););return At.resolve(o)}wt(t,e,n){const r=this.overlays.get(n.key);if(null!==r){const t=this.kr.get(r.largestBatchId).delete(n.key);this.kr.set(r.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new Rr(e,n));let i=this.kr.get(e);void 0===i&&(i=er(),this.kr.set(e,i)),this.kr.set(e,i.add(n.key))}}class Wi{constructor(){this.sessionToken=me.EMPTY_BYTE_STRING}getSessionToken(t){return At.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,At.resolve()}}class Qi{constructor(){this.qr=new de(Xi.Qr),this.$r=new de(Xi.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,e){const n=new Xi(t,e);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(t,e){t.forEach(t=>this.addReference(t,e))}removeReference(t,e){this.Wr(new Xi(t,e))}Gr(t,e){t.forEach(t=>this.removeReference(t,e))}zr(t){const e=new st(new nt([])),n=new Xi(e,t),r=new Xi(e,t+1),i=[];return this.$r.forEachInRange([n,r],t=>{this.Wr(t),i.push(t.key)}),i}jr(){this.qr.forEach(t=>this.Wr(t))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const e=new st(new nt([])),n=new Xi(e,t),r=new Xi(e,t+1);let i=er();return this.$r.forEachInRange([n,r],t=>{i=i.add(t.key)}),i}containsKey(t){const e=new Xi(t,0),n=this.qr.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class Xi{constructor(t,e){this.key=t,this.Hr=e}static Qr(t,e){return st.comparator(t.key,e.key)||X(t.Hr,e.Hr)}static Ur(t,e){return X(t.Hr,e.Hr)||st.comparator(t.key,e.key)}}class Ji{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.er=1,this.Yr=new de(Xi.Qr)}checkEmpty(t){return At.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,r){const i=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new xr(i,e,n,r);this.mutationQueue.push(s);for(const o of r)this.Yr=this.Yr.add(new Xi(o.key,i)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return At.resolve(s)}lookupMutationBatch(t,e){return At.resolve(this.Zr(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,r=this.Xr(n),i=r<0?0:r;return At.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return At.resolve(0===this.mutationQueue.length?Nt:this.er-1)}getAllMutationBatches(t){return At.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new Xi(e,0),r=new Xi(e,Number.POSITIVE_INFINITY),i=[];return this.Yr.forEachInRange([n,r],t=>{const e=this.Zr(t.Hr);i.push(e)}),At.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new de(X);return e.forEach(t=>{const e=new Xi(t,0),r=new Xi(t,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([e,r],t=>{n=n.add(t.Hr)})}),At.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,r=n.length+1;let i=n;st.isDocumentKey(i)||(i=i.child(""));const s=new Xi(new st(i),0);let o=new de(X);return this.Yr.forEachWhile(t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(o=o.add(t.Hr)),!0)},s),At.resolve(this.ei(o))}ei(t){const e=[];return t.forEach(t=>{const n=this.Zr(t);null!==n&&e.push(n)}),e}removeMutationBatch(t,e){O(0===this.ti(e.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Yr;return At.forEach(e.mutations,r=>{const i=new Xi(r.key,e.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.Yr=n})}rr(t){}containsKey(t,e){const n=new Xi(e,0),r=this.Yr.firstAfterOrEqual(n);return At.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,At.resolve()}ti(t,e){return this.Xr(t)}Xr(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}Zr(t){const e=this.Xr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class Yi{constructor(t){this.ni=t,this.docs=new le(st.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,r=this.docs.get(n),i=r?r.size:0,s=this.ni(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return At.resolve(n?n.document.mutableCopy():tn.newInvalidDocument(e))}getEntries(t,e){let n=Wn();return e.forEach(t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():tn.newInvalidDocument(t))}),At.resolve(n)}getDocumentsMatchingQuery(t,e,n,r){let i=Wn();const s=e.path,o=new st(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:t,value:{document:o}}=a.getNext();if(!s.isPrefixOf(t.path))break;t.path.length>s.length+1||Tt(bt(o),n)<=0||(r.has(o.key)||Bn(e,o))&&(i=i.insert(o.key,o.mutableCopy()))}return At.resolve(i)}getAllFromCollectionGroup(t,e,n,r){x(9500)}ri(t,e){return At.forEach(this.docs,t=>e(t))}newChangeBuffer(t){return new $i(this)}getSize(t){return At.resolve(this.size)}}class $i extends qi{constructor(t){super(),this.Or=t}applyChanges(t){const e=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?e.push(this.Or.addEntry(t,r)):this.Or.removeEntry(n)}),At.waitFor(e)}getFromCache(t,e){return this.Or.getEntry(t,e)}getAllFromCache(t,e){return this.Or.getEntries(t,e)}}class Zi{constructor(t){this.persistence=t,this.ii=new Hn(t=>An(t),In),this.lastRemoteSnapshotVersion=mt.min(),this.highestTargetId=0,this.si=0,this.oi=new Qi,this.targetCount=0,this._i=Pi.ar()}forEachTarget(t,e){return this.ii.forEach((t,n)=>e(n)),At.resolve()}getLastRemoteSnapshotVersion(t){return At.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return At.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),At.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.si&&(this.si=e),At.resolve()}hr(t){this.ii.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this._i=new Pi(e),this.highestTargetId=e),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,e){return this.hr(e),this.targetCount+=1,At.resolve()}updateTargetData(t,e){return this.hr(e),At.resolve()}removeTargetData(t,e){return this.ii.delete(e.target),this.oi.zr(e.targetId),this.targetCount-=1,At.resolve()}removeTargets(t,e,n){let r=0;const i=[];return this.ii.forEach((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.ii.delete(s),i.push(this.removeMatchingKeysForTargetId(t,o.targetId)),r++)}),At.waitFor(i).next(()=>r)}getTargetCount(t){return At.resolve(this.targetCount)}getTargetData(t,e){const n=this.ii.get(e)||null;return At.resolve(n)}addMatchingKeys(t,e,n){return this.oi.Kr(e,n),At.resolve()}removeMatchingKeys(t,e,n){this.oi.Gr(e,n);const r=this.persistence.referenceDelegate,i=[];return r&&e.forEach(e=>{i.push(r.markPotentiallyOrphaned(t,e))}),At.waitFor(i)}removeMatchingKeysForTargetId(t,e){return this.oi.zr(e),At.resolve()}getMatchingKeysForTargetId(t,e){const n=this.oi.Jr(e);return At.resolve(n)}containsKey(t,e){return At.resolve(this.oi.containsKey(e))}}class ts{constructor(t,e){this.ai={},this.overlays={},this.ui=new kt(0),this.ci=!1,this.ci=!0,this.li=new Wi,this.referenceDelegate=t(this),this.hi=new Zi(this),this.indexManager=new ki,this.remoteDocumentCache=function(t){return new Yi(t)}(t=>this.referenceDelegate.Pi(t)),this.serializer=new Ai(e),this.Ti=new Hi(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new Gi,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.ai[t.toKey()];return n||(n=new Ji(e,this.referenceDelegate),this.ai[t.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,e,n){I("MemoryPersistence","Starting transaction:",t);const r=new es(this.ui.next());return this.referenceDelegate.Ii(),n(r).next(t=>this.referenceDelegate.di(r).next(()=>t)).toPromise().then(t=>(r.raiseOnCommittedEvent(),t))}Ei(t,e){return At.or(Object.values(this.ai).map(n=>()=>n.containsKey(t,e)))}}class es extends Ct{constructor(t){super(),this.currentSequenceNumber=t}}class ns{constructor(t){this.persistence=t,this.Ai=new Qi,this.Ri=null}static Vi(t){return new ns(t)}get mi(){if(this.Ri)return this.Ri;throw x(60996)}addReference(t,e,n){return this.Ai.addReference(n,e),this.mi.delete(n.toString()),At.resolve()}removeReference(t,e,n){return this.Ai.removeReference(n,e),this.mi.add(n.toString()),At.resolve()}markPotentiallyOrphaned(t,e){return this.mi.add(e.toString()),At.resolve()}removeTarget(t,e){this.Ai.zr(e.targetId).forEach(t=>this.mi.add(t.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next(t=>{t.forEach(t=>this.mi.add(t.toString()))}).next(()=>n.removeTargetData(t,e))}Ii(){this.Ri=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return At.forEach(this.mi,n=>{const r=st.fromPath(n);return this.fi(t,r).next(t=>{t||e.removeEntry(r,mt.min())})}).next(()=>(this.Ri=null,e.apply(t)))}updateLimboDocument(t,e){return this.fi(t,e).next(t=>{t?this.mi.delete(e.toString()):this.mi.add(e.toString())})}Pi(t){return 0}fi(t,e){return At.or([()=>At.resolve(this.Ai.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ei(t,e)])}}class rs{constructor(t,e){this.persistence=t,this.gi=new Hn(t=>Pt(t.path),(t,e)=>t.isEqual(e)),this.garbageCollector=Bi(this,e)}static Vi(t,e){return new rs(t,e)}Ii(){}di(t){return At.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}mr(t){const e=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next(t=>e.next(e=>t+e))}yr(t){let e=0;return this.gr(t,t=>{e++}).next(()=>e)}gr(t,e){return At.forEach(this.gi,(n,r)=>this.Sr(t,n,r).next(t=>t?At.resolve():e(r)))}removeTargets(t,e,n){return this.persistence.getTargetCache().removeTargets(t,e,n)}removeOrphanedDocuments(t,e){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ri(t,r=>this.Sr(t,r,e).next(t=>{t||(n++,i.removeEntry(r,mt.min()))})).next(()=>i.apply(t)).next(()=>n)}markPotentiallyOrphaned(t,e){return this.gi.set(e,t.currentSequenceNumber),At.resolve()}removeTarget(t,e){const n=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,n)}addReference(t,e,n){return this.gi.set(n,t.currentSequenceNumber),At.resolve()}removeReference(t,e,n){return this.gi.set(n,t.currentSequenceNumber),At.resolve()}updateLimboDocument(t,e){return this.gi.set(e,t.currentSequenceNumber),At.resolve()}Pi(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Ke(t.data.value)),e}Sr(t,e,n){return At.or([()=>this.persistence.Ei(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const t=this.gi.get(e);return At.resolve(void 0!==t&&t>n)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class is{constructor(t,e,n,r){this.targetId=t,this.fromCache=e,this.Is=n,this.ds=r}static Es(t,e){let n=er(),r=er();for(const i of e.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new is(t,e.fromCache,n,r)}}class ss{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class os{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(0,c.nr)()?8:It((0,c.ZQ)())>0?6:4}initialize(t,e){this.gs=t,this.indexManager=e,this.As=!0}getDocumentsMatchingQuery(t,e,n,r){const i={result:null};return this.ps(t,e).next(t=>{i.result=t}).next(()=>{if(!i.result)return this.ys(t,e,r,n).next(t=>{i.result=t})}).next(()=>{if(i.result)return;const n=new ss;return this.ws(t,e,n).next(r=>{if(i.result=r,this.Rs)return this.Ss(t,e,n,r.size)})}).next(()=>i.result)}Ss(t,e,n,r){return n.documentReadCount<this.Vs?(A()<=a.$b.DEBUG&&I("QueryEngine","SDK will not create cache indexes for query:",jn(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),At.resolve()):(A()<=a.$b.DEBUG&&I("QueryEngine","Query:",jn(e),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.fs*r?(A()<=a.$b.DEBUG&&I("QueryEngine","The SDK decides to create cache indexes for query:",jn(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Ln(e))):At.resolve())}ps(t,e){if(Rn(e))return At.resolve(null);let n=Ln(e);return this.indexManager.getIndexType(t,n).next(r=>0===r?null:(null!==e.limit&&1===r&&(e=Fn(e,null,"F"),n=Ln(e)),this.indexManager.getDocumentsMatchingTarget(t,n).next(r=>{const i=er(...r);return this.gs.getDocuments(t,i).next(r=>this.indexManager.getMinOffset(t,n).next(n=>{const s=this.bs(e,r);return this.Ds(e,s,i,n.readTime)?this.ps(t,Fn(e,null,"F")):this.vs(t,s,e,n)}))})))}ys(t,e,n,r){return Rn(e)||r.isEqual(mt.min())?At.resolve(null):this.gs.getDocuments(t,n).next(i=>{const s=this.bs(e,i);return this.Ds(e,s,n,r)?At.resolve(null):(A()<=a.$b.DEBUG&&I("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),jn(e)),this.vs(t,s,e,wt(r,yt)).next(t=>t))})}bs(t,e){let n=new de(zn(t));return e.forEach((e,r)=>{Bn(t,r)&&(n=n.add(r))}),n}Ds(t,e,n,r){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const i="F"===t.limitType?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}ws(t,e,n){return A()<=a.$b.DEBUG&&I("QueryEngine","Using full collection scan to execute query:",jn(e)),this.gs.getDocumentsMatchingQuery(t,e,Et.min(),n)}vs(t,e,n,r){return this.gs.getDocumentsMatchingQuery(t,n,r).next(t=>(e.forEach(e=>{t=t.insert(e.key,e)}),t))}}const as="LocalStore",cs=3e8;class ls{constructor(t,e,n,r){this.persistence=t,this.Cs=e,this.serializer=r,this.Fs=new le(X),this.Ms=new Hn(t=>An(t),In),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(n)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new Ki(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.Fs))}}function us(t,e,n,r){return new ls(t,e,n,r)}async function hs(t,e){const n=P(t);return await n.persistence.runTransaction("Handle user change","readonly",t=>{let r;return n.mutationQueue.getAllMutationBatches(t).next(i=>(r=i,n.Ns(e),n.mutationQueue.getAllMutationBatches(t))).next(e=>{const i=[],s=[];let o=er();for(const t of r){i.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next(t=>({Bs:t,removedBatchIds:i,addedBatchIds:s}))})})}function ds(t){const e=P(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function fs(t,e,n){let r=er(),i=er();return n.forEach(t=>r=r.add(t)),e.getEntries(t,r).next(t=>{let r=Wn();return n.forEach((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(mt.min())?(e.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),r=r.insert(n,s)):I(as,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Ls:r,ks:i}})}function ps(t,e){const n=P(t);return n.persistence.runTransaction("Allocate target","readwrite",t=>{let r;return n.hi.getTargetData(t,e).next(i=>i?(r=i,At.resolve(r)):n.hi.allocateTargetId(t).next(i=>(r=new Si(e,i,"TargetPurposeListen",t.currentSequenceNumber),n.hi.addTargetData(t,r).next(()=>r))))}).then(t=>{const r=n.Fs.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(t.targetId,t),n.Ms.set(e,t.targetId)),t})}async function gs(t,e,n){const r=P(t),i=r.Fs.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,t=>r.persistence.referenceDelegate.removeTarget(t,i))}catch(t){if(!Dt(t))throw t;I(as,"Failed to update sequence numbers for target ".concat(e,": ").concat(t))}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function ms(t,e,n){const r=P(t);let i=mt.min(),s=er();return r.persistence.runTransaction("Execute query","readwrite",t=>function(t,e,n){const r=P(t),i=r.Ms.get(n);return void 0!==i?At.resolve(r.Fs.get(i)):r.hi.getTargetData(e,n)}(r,t,Ln(e)).next(e=>{if(e)return i=e.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(t,e.targetId).next(t=>{s=t})}).next(()=>r.Cs.getDocumentsMatchingQuery(t,e,n?i:mt.min(),n?s:er())).next(t=>(ys(r,qn(e),t),{documents:t,qs:s})))}function ys(t,e,n){let r=t.xs.get(e)||mt.min();n.forEach((t,e)=>{e.readTime.compareTo(r)>0&&(r=e.readTime)}),t.xs.set(e,r)}class vs{constructor(){this.activeTargetIds=rr()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class ws{constructor(){this.Fo=new vs,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,e,n){this.Mo[t]=e}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new vs,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class bs{xo(t){}shutdown(){}}const Es="ConnectivityMonitor";class Ts{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){I(Es,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){I(Es,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let _s=null;function Cs(){return null===_s?_s=268435456+Math.round(2147483648*Math.random()):_s++,"0x"+_s.toString(16)}const Ss="RestConnection",As={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Is{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.$o=e+"://"+t.host,this.Uo="projects/".concat(n,"/databases/").concat(r),this.Ko=this.databaseId.database===ke?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Wo(t,e,n,r,i){const s=Cs(),o=this.Go(t,e.toUriEncodedString());I(Ss,"Sending RPC '".concat(t,"' ").concat(s,":"),o,n);const a={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(a,r,i);const{host:l}=new URL(o),u=(0,c.zJ)(l);return this.jo(t,o,a,n,u).then(e=>(I(Ss,"Received RPC '".concat(t,"' ").concat(s,": "),e),e),e=>{throw k(Ss,"RPC '".concat(t,"' ").concat(s," failed with error: "),e,"url: ",o,"request:",n),e})}Jo(t,e,n,r,i,s){return this.Wo(t,e,n,r,i)}zo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+C,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach((e,n)=>t[n]=e),n&&n.headers.forEach((e,n)=>t[n]=e)}Go(t,e){const n=As[t];return"".concat(this.$o,"/v1/").concat(e,":").concat(n)}terminate(){}}class Ds{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}const ks="WebChannelConnection";class Ns extends Is{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,e,n,r,i){const s=Cs();return new Promise((i,o)=>{const a=new h;a.setWithCredentials(!0),a.listenOnce(f.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case p.NO_ERROR:const e=a.getResponseJson();I(ks,"XHR for RPC '".concat(t,"' ").concat(s," received:"),JSON.stringify(e)),i(e);break;case p.TIMEOUT:I(ks,"RPC '".concat(t,"' ").concat(s," timed out")),o(new M(L.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:const n=a.getStatus();if(I(ks,"RPC '".concat(t,"' ").concat(s," failed with status:"),n,"response text:",a.getResponseText()),n>0){let t=a.getResponseJson();Array.isArray(t)&&(t=t[0]);const e=null==t?void 0:t.error;if(e&&e.status&&e.message){const t=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(L).indexOf(e)>=0?e:L.UNKNOWN}(e.status);o(new M(t,e.message))}else o(new M(L.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new M(L.UNAVAILABLE,"Connection failed."));break;default:x(9055,{c_:t,streamId:s,l_:a.getLastErrorCode(),h_:a.getLastError()})}}finally{I(ks,"RPC '".concat(t,"' ").concat(s," completed."))}});const c=JSON.stringify(r);I(ks,"RPC '".concat(t,"' ").concat(s," sending request:"),r),a.send(e,"POST",c,n,15)})}P_(t,e,n){const r=Cs(),i=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],s=v(),o=y(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.zo(a.initMessageHeaders,e,n),a.encodeInitMessageHeaders=!0;const l=i.join("");I(ks,"Creating RPC '".concat(t,"' stream ").concat(r,": ").concat(l),a);const u=s.createWebChannel(l,a);this.T_(u);let h=!1,f=!1;const p=new Ds({Ho:e=>{f?I(ks,"Not sending because RPC '".concat(t,"' stream ").concat(r," is closed:"),e):(h||(I(ks,"Opening RPC '".concat(t,"' stream ").concat(r," transport.")),u.open(),h=!0),I(ks,"RPC '".concat(t,"' stream ").concat(r," sending:"),e),u.send(e))},Yo:()=>u.close()}),w=(t,e,n)=>{t.listen(e,t=>{try{n(t)}catch(t){setTimeout(()=>{throw t},0)}})};return w(u,d.EventType.OPEN,()=>{f||(I(ks,"RPC '".concat(t,"' stream ").concat(r," transport opened.")),p.s_())}),w(u,d.EventType.CLOSE,()=>{f||(f=!0,I(ks,"RPC '".concat(t,"' stream ").concat(r," transport closed")),p.__(),this.I_(u))}),w(u,d.EventType.ERROR,e=>{f||(f=!0,k(ks,"RPC '".concat(t,"' stream ").concat(r," transport errored. Name:"),e.name,"Message:",e.message),p.__(new M(L.UNAVAILABLE,"The operation could not be completed")))}),w(u,d.EventType.MESSAGE,e=>{var n;if(!f){const i=e.data[0];O(!!i,16349);const s=i,o=(null==s?void 0:s.error)||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){I(ks,"RPC '".concat(t,"' stream ").concat(r," received error:"),o);const e=o.status;let n=function(t){const e=Pr[t];if(void 0!==e)return Mr(e)}(e),i=o.message;void 0===n&&(n=L.INTERNAL,i="Unknown error status: "+e+" with message "+o.message),f=!0,p.__(new M(n,i)),u.close()}else I(ks,"RPC '".concat(t,"' stream ").concat(r," received:"),i),p.a_(i)}}),w(o,m.STAT_EVENT,e=>{e.stat===g.PROXY?I(ks,"RPC '".concat(t,"' stream ").concat(r," detected buffering proxy")):e.stat===g.NOPROXY&&I(ks,"RPC '".concat(t,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{p.o_()},0),p}terminate(){this.u_.forEach(t=>t.close()),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter(e=>e===t)}}function xs(){return"undefined"!=typeof document?document:null}function Rs(t){return new ei(t,!0)}class Os{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Fi=t,this.timerId=e,this.d_=n,this.E_=r,this.A_=i,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const e=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),r=Math.max(0,e-n);r>0&&I("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.R_," ms, delay with jitter: ").concat(e," ms, last attempt: ").concat(n," ms ago)")),this.V_=this.Fi.enqueueAfterDelay(this.timerId,r,()=>(this.m_=Date.now(),t())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){null!==this.V_&&(this.V_.skipDelay(),this.V_=null)}cancel(){null!==this.V_&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}const Ps="PersistentStream";class Ls{constructor(t,e,n,r,i,s,o,a){this.Fi=t,this.w_=n,this.S_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Os(t,e)}M_(){return 1===this.state||5===this.state||this.x_()}x_(){return 2===this.state||3===this.state}start(){this.C_=0,4!==this.state?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&null===this.D_&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,4!==t?this.F_.reset():e&&e.code===L.RESOURCE_EXHAUSTED?(D(e.toString()),D("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):e&&e.code===L.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(e)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),e=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(t=>{let[n,r]=t;this.b_===e&&this.W_(n,r)},e=>{t(()=>{const t=new M(L.UNKNOWN,"Fetching auth token failed: "+e.message);return this.G_(t)})})}W_(t,e){const n=this.K_(this.b_);this.stream=this.z_(t,e),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(t=>{n(()=>this.G_(t))}),this.stream.onMessage(t=>{n(()=>1==++this.C_?this.j_(t):this.onNext(t))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(t){return I(Ps,"close with error: ".concat(t)),this.stream=null,this.close(4,t)}K_(t){return e=>{this.Fi.enqueueAndForget(()=>this.b_===t?e():(I(Ps,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Ms extends Ls{constructor(t,e,n,r,i,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,r,s),this.serializer=i}z_(t,e){return this.connection.P_("Listen",t,e)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:x(39313,{state:t})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(t,e){return t.useProto3Json?(O(void 0===e||"string"==typeof e,58123),me.fromBase64String(e||"")):(O(void 0===e||e instanceof Buffer||e instanceof Uint8Array,16193),me.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?L.UNKNOWN:Mr(t.code);return new M(e,t.message||"")}(o);n=new Wr(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=li(t,r.document.name),s=si(r.document.updateTime),o=r.document.createTime?si(r.document.createTime):mt.min(),a=new Ze({mapValue:{fields:r.document.fields}}),c=tn.newFoundDocument(i,s,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new Hr(l,u,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=li(t,r.document),s=r.readTime?si(r.readTime):mt.min(),o=tn.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Hr([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=li(t,r.document),s=r.removedTargetIds||[];n=new Hr([],s,i,null)}else{if(!("filter"in e))return x(11601,{At:e});{e.filter;const t=e.filter;t.targetId;const{count:r=0,unchangedNames:i}=t,s=new Or(r,i),o=t.targetId;n=new Gr(o,s)}}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return mt.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?mt.min():e.readTime?si(e.readTime):mt.min()}(t);return this.listener.J_(e,n)}H_(t){const e={};e.database=di(this.serializer),e.addTarget=function(t,e){let n;const r=e.target;if(n=Dn(r)?{documents:pi(t,r)}:{query:gi(t,r).Vt},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0){n.resumeToken=ii(t,e.resumeToken);const r=ni(t,e.expectedCount);null!==r&&(n.expectedCount=r)}else if(e.snapshotVersion.compareTo(mt.min())>0){n.readTime=ri(t,e.snapshotVersion.toTimestamp());const r=ni(t,e.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,t);const n=function(t,e){const n=function(t){switch(t){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return x(28987,{purpose:t})}}(e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.k_(e)}Y_(t){const e={};e.database=di(this.serializer),e.removeTarget=t,this.k_(e)}}class Fs{}class Vs extends Fs{constructor(t,e,n,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=n,this.serializer=r,this.ra=!1}ia(){if(this.ra)throw new M(L.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,e,n,r){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.Wo(t,ai(e,n),r,s,o)}).catch(t=>{throw"FirebaseError"===t.name?(t.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new M(L.UNKNOWN,t.toString())})}Jo(t,e,n,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[o,a]=s;return this.connection.Jo(t,ai(e,n),r,o,a,i)}).catch(t=>{throw"FirebaseError"===t.name?(t.code===L.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new M(L.UNKNOWN,t.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class Us{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){0===this.sa&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(t){"Online"===this.state?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca("Connection failed 1 times. Most recent error: ".concat(t.toString())),this.ua("Offline")))}set(t){this.ha(),this.sa=0,"Online"===t&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const e="Could not reach Cloud Firestore backend. ".concat(t,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this._a?(D(e),this._a=!1):I("OnlineStateTracker",e)}ha(){null!==this.oa&&(this.oa.cancel(),this.oa=null)}}const js="RemoteStore";class Bs{constructor(t,e,n,r,i){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=i,this.Ea.xo(t=>{n.enqueueAndForget(async()=>{Js(this)&&(I(js,"Restarting streams for network reachability change."),await async function(t){const e=P(t);e.Ia.add(4),await zs(e),e.Aa.set("Unknown"),e.Ia.delete(4),await qs(e)}(this))})}),this.Aa=new Us(n,r)}}async function qs(t){if(Js(t))for(const e of t.da)await e(!0)}async function zs(t){for(const e of t.da)await e(!1)}function Ks(t,e){const n=P(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),Xs(n)?Qs(n):so(n).x_()&&Gs(n,e))}function Hs(t,e){const n=P(t),r=so(n);n.Ta.delete(e),r.x_()&&Ws(n,e),0===n.Ta.size&&(r.x_()?r.B_():Js(n)&&n.Aa.set("Unknown"))}function Gs(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}so(t).H_(e)}function Ws(t,e){t.Ra.$e(e),so(t).Y_(e)}function Qs(t){t.Ra=new Xr({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),so(t).start(),t.Aa.aa()}function Xs(t){return Js(t)&&!so(t).M_()&&t.Ta.size>0}function Js(t){return 0===P(t).Ia.size}function Ys(t){t.Ra=void 0}async function $s(t){t.Aa.set("Online")}async function Zs(t){t.Ta.forEach((e,n)=>{Gs(t,e)})}async function to(t,e){Ys(t),Xs(t)?(t.Aa.la(e),Qs(t)):t.Aa.set("Unknown")}async function eo(t,e,n){if(t.Aa.set("Online"),e instanceof Wr&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const r of e.targetIds)t.Ta.has(r)&&(await t.remoteSyncer.rejectListen(r,n),t.Ta.delete(r),t.Ra.removeTarget(r))}(t,e)}catch(n){I(js,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await no(t,n)}else if(e instanceof Hr?t.Ra.Ye(e):e instanceof Gr?t.Ra.it(e):t.Ra.et(e),!n.isEqual(mt.min()))try{const e=await ds(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.Ra.Pt(e);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=t.Ta.get(r);i&&t.Ta.set(r,i.withResumeToken(n.resumeToken,e))}}),n.targetMismatches.forEach((e,n)=>{const r=t.Ta.get(e);if(!r)return;t.Ta.set(e,r.withResumeToken(me.EMPTY_BYTE_STRING,r.snapshotVersion)),Ws(t,e);const i=new Si(r.target,e,n,r.sequenceNumber);Gs(t,i)}),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){I(js,"Failed to raise snapshot:",e),await no(t,e)}}async function no(t,e,n){if(!Dt(e))throw e;t.Ia.add(1),await zs(t),t.Aa.set("Offline"),n||(n=()=>ds(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{I(js,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await qs(t)})}async function ro(t,e){const n=P(t);n.asyncQueue.verifyOperationInProgress(),I(js,"RemoteStore received new credentials");const r=Js(n);n.Ia.add(3),await zs(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await qs(n)}async function io(t,e){const n=P(t);e?(n.Ia.delete(2),await qs(n)):e||(n.Ia.add(2),await zs(n),n.Aa.set("Unknown"))}function so(t){return t.Va||(t.Va=function(t,e,n){const r=P(t);return r.ia(),new Ms(e,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(t.datastore,t.asyncQueue,{Zo:$s.bind(null,t),e_:Zs.bind(null,t),n_:to.bind(null,t),J_:eo.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Xs(t)?Qs(t):t.Aa.set("Unknown")):(await t.Va.stop(),Ys(t))})),t.Va}class oo{constructor(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new F,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(t=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,n,r,i){const s=Date.now()+n,o=new oo(t,e,s,r,i);return o.start(n),o}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new M(L.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ao(t,e){if(D("AsyncQueue","".concat(e,": ").concat(t)),Dt(t))return new M(L.UNAVAILABLE,"".concat(e,": ").concat(t));throw t}class co{static emptySet(t){return new co(t.comparator)}constructor(t){this.comparator=t?(e,n)=>t(e,n)||st.comparator(e.key,n.key):(t,e)=>st.comparator(t.key,e.key),this.keyedMap=Xn(),this.sortedSet=new le(this.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,n)=>(t(e),!1))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof co))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(!t.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach(e=>{t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new co;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class lo{constructor(){this.fa=new le(st.comparator)}track(t){const e=t.doc.key,n=this.fa.get(e);n?0!==t.type&&3===n.type?this.fa=this.fa.insert(e,t):3===t.type&&1!==n.type?this.fa=this.fa.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.fa=this.fa.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.fa=this.fa.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.fa=this.fa.remove(e):1===t.type&&2===n.type?this.fa=this.fa.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.fa=this.fa.insert(e,{type:2,doc:t.doc}):x(63341,{At:t,ga:n}):this.fa=this.fa.insert(e,t)}pa(){const t=[];return this.fa.inorderTraversal((e,n)=>{t.push(n)}),t}}class uo{constructor(t,e,n,r,i,s,o,a,c){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(t,e,n,r,i){const s=[];return e.forEach(t=>{s.push({type:0,doc:t})}),new uo(t,e,co.emptySet(e),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Vn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0}}class ho{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(t=>t.ba())}}class fo{constructor(){this.queries=po(),this.onlineState="Unknown",this.Da=new Set}terminate(){!function(t,e){const n=P(t),r=n.queries;n.queries=po(),r.forEach((t,n)=>{for(const r of n.wa)r.onError(e)})}(this,new M(L.ABORTED,"Firestore shutting down"))}}function po(){return new Hn(t=>Un(t),Vn)}async function go(t,e){const n=P(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new ho,r=e.ba()?0:1);try{switch(r){case 0:s.ya=await n.onListen(i,!0);break;case 1:s.ya=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(t){const n=ao(t,"Initialization of query '".concat(jn(e.query),"' failed"));return void e.onError(n)}n.queries.set(i,s),s.wa.push(e),e.va(n.onlineState),s.ya&&e.Ca(s.ya)&&wo(n)}async function mo(t,e){const n=P(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const t=s.wa.indexOf(e);t>=0&&(s.wa.splice(t,1),0===s.wa.length?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function yo(t,e){const n=P(t);let r=!1;for(const i of e){const t=i.query,e=n.queries.get(t);if(e){for(const t of e.wa)t.Ca(i)&&(r=!0);e.ya=i}}r&&wo(n)}function vo(t,e,n){const r=P(t),i=r.queries.get(e);if(i)for(const s of i.wa)s.onError(n);r.queries.delete(e)}function wo(t){t.Da.forEach(t=>{t.next()})}var bo,Eo;(Eo=bo||(bo={})).Fa="default",Eo.Cache="cache";class To{constructor(t,e,n){this.query=t,this.Ma=e,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new uo(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),e=!0):this.Ba(t,this.onlineState)&&(this.La(t),e=!0),this.Oa=t,e}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let e=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),e=!0),e}Ba(t,e){if(!t.fromCache)return!0;if(!this.ba())return!0;const n="Offline"!==e;return(!this.options.ka||!n)&&(!t.docs.isEmpty()||t.hasCachedResults||"Offline"===e)}Na(t){if(t.docChanges.length>0)return!0;const e=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}La(t){t=uo.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==bo.Cache}}class _o{constructor(t){this.key=t}}class Co{constructor(t){this.key=t}}class So{constructor(t,e){this.query=t,this.Ha=e,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=er(),this.mutatedKeys=er(),this.Xa=zn(t),this.eu=new co(this.Xa)}get tu(){return this.Ha}nu(t,e){const n=e?e.ru:new lo,r=e?e.eu:this.eu;let i=e?e.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((t,e)=>{const l=r.get(t),u=Bn(this.query,e)?e:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.iu(l,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Xa(u,a)>0||c&&this.Xa(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(t):i.delete(t)):(s=s.delete(t),i=i.delete(t)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),i=i.delete(t.key),n.track({type:1,doc:t})}return{eu:s,ru:n,Ds:o,mutatedKeys:i}}iu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n,r){const i=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const s=t.ru.pa();s.sort((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return x(20277,{At:t})}};return n(t)-n(e)}(t.type,e.type)||this.Xa(t.doc,e.doc)),this.su(n),r=null!=r&&r;const o=e&&!r?this.ou():[],a=0===this.Za.size&&this.current&&!r?1:0,c=a!==this.Ya;return this.Ya=a,0!==s.length||c?{snapshot:new uo(this.query,t.eu,i,s,t.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:o}:{_u:o}}va(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({eu:this.eu,ru:new lo,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),t.modifiedDocuments.forEach(t=>{}),t.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=er(),this.eu.forEach(t=>{this.au(t.key)&&(this.Za=this.Za.add(t.key))});const e=[];return t.forEach(t=>{this.Za.has(t)||e.push(new Co(t))}),this.Za.forEach(n=>{t.has(n)||e.push(new _o(n))}),e}uu(t){this.Ha=t.qs,this.Za=er();const e=this.nu(t.documents);return this.applyChanges(e,!0)}cu(){return uo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,0===this.Ya,this.hasCachedResults)}}const Ao="SyncEngine";class Io{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Do{constructor(t){this.key=t,this.lu=!1}}class ko{constructor(t,e,n,r,i,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.hu={},this.Pu=new Hn(t=>Un(t),Vn),this.Tu=new Map,this.Iu=new Set,this.du=new le(st.comparator),this.Eu=new Map,this.Au=new Qi,this.Ru={},this.Vu=new Map,this.mu=Pi.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return!0===this.fu}}async function No(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Wo(t);let i;const s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await Ro(r,e,n,!0),i}async function xo(t,e){const n=Wo(t);await Ro(n,e,!0,!1)}async function Ro(t,e,n,r){const i=await ps(t.localStore,Ln(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Oo(t,e,s,"current"===o,i.resumeToken)),t.isPrimaryClient&&n&&Ks(t.remoteStore,i),a}async function Oo(t,e,n,r,i){t.gu=(e,n,r)=>async function(t,e,n,r){let i=e.view.nu(n);i.Ds&&(i=await ms(t.localStore,e.query,!1).then(t=>{let{documents:n}=t;return e.view.nu(n,i)}));const s=r&&r.targetChanges.get(e.targetId),o=r&&null!=r.targetMismatches.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,s,o);return Bo(t,e.targetId,a._u),a.snapshot}(t,e,n,r);const s=await ms(t.localStore,e,!0),o=new So(e,s.qs),a=o.nu(s.documents),c=Kr.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState,i),l=o.applyChanges(a,t.isPrimaryClient,c);Bo(t,n,l._u);const u=new Io(e,n,o);return t.Pu.set(e,u),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),l.snapshot}async function Po(t,e,n){const r=P(t),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(t=>!Vn(t,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await gs(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Hs(r.remoteStore,i.targetId),Uo(r,i.targetId)}).catch(St)):(Uo(r,i.targetId),await gs(r.localStore,i.targetId,!0))}async function Lo(t,e){const n=P(t),r=n.Pu.get(e),i=n.Tu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Hs(n.remoteStore,r.targetId))}async function Mo(t,e){const n=P(t);try{const t=await function(t,e){const n=P(t),r=e.snapshotVersion;let i=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",t=>{const s=n.Os.newChangeBuffer({trackRemovals:!0});i=n.Fs;const o=[];e.targetChanges.forEach((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.hi.removeMatchingKeys(t,s.removedDocuments,a).next(()=>n.hi.addMatchingKeys(t,s.addedDocuments,a)));let l=c.withSequenceNumber(t.currentSequenceNumber);null!==e.targetMismatches.get(a)?l=l.withResumeToken(me.EMPTY_BYTE_STRING,mt.min()).withLastLimboFreeSnapshotVersion(mt.min()):s.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(s.resumeToken,r)),i=i.insert(a,l),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||(e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=cs||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(c,l,s)&&o.push(n.hi.updateTargetData(t,l))});let a=Wn(),c=er();if(e.documentUpdates.forEach(r=>{e.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))}),o.push(fs(t,s,e.documentUpdates).next(t=>{a=t.Ls,c=t.ks})),!r.isEqual(mt.min())){const e=n.hi.getLastRemoteSnapshotVersion(t).next(e=>n.hi.setTargetsMetadata(t,t.currentSequenceNumber,r));o.push(e)}return At.waitFor(o).next(()=>s.apply(t)).next(()=>n.localDocuments.getLocalViewOfDocuments(t,a,c)).next(()=>a)}).then(t=>(n.Fs=i,t))}(n.localStore,e);e.targetChanges.forEach((t,e)=>{const r=n.Eu.get(e);r&&(O(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1,22616),t.addedDocuments.size>0?r.lu=!0:t.modifiedDocuments.size>0?O(r.lu,14607):t.removedDocuments.size>0&&(O(r.lu,42227),r.lu=!1))}),await Ko(n,t,e)}catch(t){await St(t)}}function Fo(t,e,n){const r=P(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const t=[];r.Pu.forEach((n,r)=>{const i=r.view.va(e);i.snapshot&&t.push(i.snapshot)}),function(t,e){const n=P(t);n.onlineState=e;let r=!1;n.queries.forEach((t,n)=>{for(const i of n.wa)i.va(e)&&(r=!0)}),r&&wo(n)}(r.eventManager,e),t.length&&r.hu.J_(t),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Vo(t,e,n){const r=P(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Eu.get(e),s=i&&i.key;if(s){let t=new le(st.comparator);t=t.insert(s,tn.newNoDocument(s,mt.min()));const n=er().add(s),i=new zr(mt.min(),new Map,new le(X),t,n);await Mo(r,i),r.du=r.du.remove(s),r.Eu.delete(e),zo(r)}else await gs(r.localStore,e,!1).then(()=>Uo(r,e,n)).catch(St)}function Uo(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(e=>{t.Au.containsKey(e)||jo(t,e)})}function jo(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);null!==n&&(Hs(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),zo(t))}function Bo(t,e,n){for(const r of n)r instanceof _o?(t.Au.addReference(r.key,e),qo(t,r)):r instanceof Co?(I(Ao,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||jo(t,r.key)):x(19791,{yu:r})}function qo(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(I(Ao,"New document in limbo: "+n),t.Iu.add(r),zo(t))}function zo(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new st(nt.fromString(e)),r=t.mu.next();t.Eu.set(r,new Do(n)),t.du=t.du.insert(n,r),Ks(t.remoteStore,new Si(Ln(xn(n.path)),r,"TargetPurposeLimboResolution",kt.ue))}}async function Ko(t,e,n){const r=P(t),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((t,a)=>{o.push(r.gu(a,e,n).then(t=>{var e;if((t||n)&&r.isPrimaryClient){const i=t?!t.fromCache:null===(e=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===e?void 0:e.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(t){i.push(t);const e=is.Es(a.targetId,t);s.push(e)}}))}),await Promise.all(o),r.hu.J_(i),await async function(t,e){const n=P(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",t=>At.forEach(e,e=>At.forEach(e.Is,r=>n.persistence.referenceDelegate.addReference(t,e.targetId,r)).next(()=>At.forEach(e.ds,r=>n.persistence.referenceDelegate.removeReference(t,e.targetId,r)))))}catch(t){if(!Dt(t))throw t;I(as,"Failed to update sequence numbers: "+t)}for(const r of e){const t=r.targetId;if(!r.fromCache){const e=n.Fs.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Fs=n.Fs.insert(t,i)}}}(r.localStore,s))}async function Ho(t,e){const n=P(t);if(!n.currentUser.isEqual(e)){I(Ao,"User change. New user:",e.toKey());const t=await hs(n.localStore,e);n.currentUser=e,function(t,e){t.Vu.forEach(t=>{t.forEach(t=>{t.reject(new M(L.CANCELLED,e))})}),t.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await Ko(n,t.Bs)}}function Go(t,e){const n=P(t),r=n.Eu.get(e);if(r&&r.lu)return er().add(r.key);{let t=er();const r=n.Tu.get(e);if(!r)return t;for(const e of r){const r=n.Pu.get(e);t=t.unionWith(r.view.tu)}return t}}function Wo(t){const e=P(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Mo.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Go.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Vo.bind(null,e),e.hu.J_=yo.bind(null,e.eventManager),e.hu.pu=vo.bind(null,e.eventManager),e}class Qo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Rs(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,e){return null}Fu(t,e){return null}vu(t){return us(this.persistence,new os,t.initialUser,this.serializer)}Du(t){return new ts(ns.Vi,this.serializer)}bu(t){return new ws}async terminate(){var t,e;null===(t=this.gcScheduler)||void 0===t||t.stop(),null===(e=this.indexBackfillerScheduler)||void 0===e||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Qo.provider={build:()=>new Qo};class Xo extends Qo{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,e){O(this.persistence.referenceDelegate instanceof rs,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Ui(n,t.asyncQueue,e)}Du(t){const e=void 0!==this.cacheSizeBytes?Oi.withCacheSize(this.cacheSizeBytes):Oi.DEFAULT;return new ts(t=>rs.Vi(t,e),this.serializer)}}class Jo{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Fo(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ho.bind(null,this.syncEngine),await io(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new fo}createDatastore(t){const e=Rs(t.databaseInfo.databaseId),n=function(t){return new Ns(t)}(t.databaseInfo);return function(t,e,n,r){return new Vs(t,e,n,r)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return function(t,e,n,r,i){return new Bs(t,e,n,r,i)}(this.localStore,this.datastore,t.asyncQueue,t=>Fo(this.syncEngine,t,0),Ts.C()?new Ts:new bs)}createSyncEngine(t,e){return function(t,e,n,r,i,s,o){const a=new ko(t,e,n,r,i,s);return o&&(a.fu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await async function(t){const e=P(t);I(js,"RemoteStore shutting down."),e.Ia.add(5),await zs(e),e.Ea.shutdown(),e.Aa.set("Unknown")}(this.remoteStore),null===(t=this.datastore)||void 0===t||t.terminate(),null===(e=this.eventManager)||void 0===e||e.terminate()}}Jo.provider={build:()=>new Jo};class Yo{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):D("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,e){setTimeout(()=>{this.muted||t(e)},0)}}const $o="FirestoreClient";class Zo{constructor(t,e,n,r,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=_.UNAUTHENTICATED,this.clientId=Q.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async t=>{I($o,"Received user=",t.uid),await this.authCredentialListener(t),this.user=t}),this.appCheckCredentials.start(n,t=>(I($o,"Received new app check token=",t),this.appCheckCredentialListener(t,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new F;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=ao(e,"Failed to shutdown persistence");t.reject(n)}}),t.promise}}async function ta(t,e){t.asyncQueue.verifyOperationInProgress(),I($o,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async t=>{r.isEqual(t)||(await hs(e.localStore,t),r=t)}),e.persistence.setDatabaseDeletedListener(()=>{k("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{I("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(t=>{k("Terminating Firestore due to IndexedDb database deletion failed",t)})}),t._offlineComponents=e}async function ea(t,e){t.asyncQueue.verifyOperationInProgress();const n=await na(t);I($o,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(t=>ro(e.remoteStore,t)),t.setAppCheckTokenChangeListener((t,n)=>ro(e.remoteStore,n)),t._onlineComponents=e}async function na(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){I($o,"Using user provided OfflineComponentProvider");try{await ta(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(t){return"FirebaseError"===t.name?t.code===L.FAILED_PRECONDITION||t.code===L.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(n))throw n;k("Error using user provided cache. Falling back to memory cache: "+n),await ta(t,new Qo)}}else I($o,"Using default OfflineComponentProvider"),await ta(t,new Xo(void 0));return t._offlineComponents}async function ra(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(I($o,"Using user provided OnlineComponentProvider"),await ea(t,t._uninitializedComponentsProvider._online)):(I($o,"Using default OnlineComponentProvider"),await ea(t,new Jo))),t._onlineComponents}async function ia(t){const e=await ra(t),n=e.eventManager;return n.onListen=No.bind(null,e.syncEngine),n.onUnlisten=Po.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=xo.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Lo.bind(null,e.syncEngine),n}function sa(t){const e={};return void 0!==t.timeoutSeconds&&(e.timeoutSeconds=t.timeoutSeconds),e}const oa=new Map,aa="firestore.googleapis.com",ca=!0;class la{constructor(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new M(L.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=aa,this.ssl=ca}else this.host=t.host,this.ssl=null!==(e=t.ssl)&&void 0!==e?e:ca;if(this.isUsingEmulator=void 0!==t.emulatorOptions,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ri;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<Mi)throw new M(L.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new M(L.INVALID_ARGUMENT,"".concat(t," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sa(null!==(n=t.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(t){if(void 0!==t.timeoutSeconds){if(isNaN(t.timeoutSeconds))throw new M(L.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (must not be NaN)"));if(t.timeoutSeconds<5)throw new M(L.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (minimum allowed value is 5)"));if(t.timeoutSeconds>30)throw new M(L.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(t.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(t,e){return t.timeoutSeconds===e.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class ua{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new la({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new M(L.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new M(L.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new la(t),this._emulatorOptions=t.emulatorOptions||{},void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new U;switch(t.type){case"firstParty":return new z(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new M(L.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=oa.get(t);e&&(I("ComponentProvider","Removing Datastore"),oa.delete(t),e.terminate())}(this),Promise.resolve()}}class ha{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new ha(this.firestore,t,this._query)}}class da{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fa(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new da(this.firestore,t,this._key)}toJSON(){return{type:da._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,n){if(dt(e,da._jsonSchema))return new da(t,n||null,new st(nt.fromString(e.referencePath)))}}da._jsonSchemaVersion="firestore/documentReference/1.0",da._jsonSchema={type:ht("string",da._jsonSchemaVersion),referencePath:ht("string")};class fa extends ha{constructor(t,e,n){super(t,e,xn(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new da(this.firestore,null,new st(t))}withConverter(t){return new fa(this.firestore,t,this._path)}}function pa(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(t=(0,c.Ku)(t),ot("collection","path",e),t instanceof ua){const n=nt.fromString(e,...r);return at(n),new fa(t,null,n)}{if(!(t instanceof da||t instanceof fa))throw new M(L.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(nt.fromString(e,...r));return at(n),new fa(t.firestore,null,n)}}const ga="AsyncQueue";class ma{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Os(this,"async_queue_retry"),this.oc=()=>{const t=xs();t&&I(ga,"Visibility state changed to "+t.visibilityState),this.F_.y_()},this._c=t;const e=xs();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const e=xs();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise(()=>{});const e=new F;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.Zu.push(t),this.cc()))}async cc(){if(0!==this.Zu.length){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!Dt(t))throw t;I(ga,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(t){const e=this._c.then(()=>(this.nc=!0,t().catch(t=>{throw this.tc=t,this.nc=!1,D("INTERNAL UNHANDLED ERROR: ",ya(t)),t}).then(t=>(this.nc=!1,t))));return this._c=e,e}enqueueAfterDelay(t,e,n){this.ac(),this.sc.indexOf(t)>-1&&(e=0);const r=oo.createAndSchedule(this,t,e,n,t=>this.lc(t));return this.ec.push(r),r}ac(){this.tc&&x(47125,{hc:ya(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do{t=this._c,await t}while(t!==this._c)}Tc(t){for(const e of this.ec)if(e.timerId===t)return!0;return!1}Ic(t){return this.Pc().then(()=>{this.ec.sort((t,e)=>t.targetTimeMs-e.targetTimeMs);for(const e of this.ec)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.Pc()})}dc(t){this.sc.push(t)}lc(t){const e=this.ec.indexOf(t);this.ec.splice(e,1)}}function ya(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}function va(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const r of e)if(r in n&&"function"==typeof n[r])return!0;return!1}(t,["next","error","complete"])}class wa extends ua{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new ma,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new ma(t),this._firestoreClient=void 0,await t}}}function ba(t,e){const n="object"==typeof t?t:(0,s.Sx)(),r="string"==typeof t?t:e||ke,i=(0,s.j6)(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const t=(0,c.yU)("firestore");t&&function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;t=ut(t,ua);const s=(0,c.zJ)(e),o=t._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),l="".concat(e,":").concat(n);s&&((0,c.gE)("https://".concat(l)),(0,c.P1)("Firestore",!0)),o.host!==aa&&o.host!==l&&k("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:l,ssl:s,emulatorOptions:r});if(!(0,c.bD)(u,a)&&(t._setSettings(u),r.mockUserToken)){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=_.MOCK_USER;else{e=(0,c.Fy)(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new M(L.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new _(s)}t._authCredentials=new j(new V(e,n))}}(i,...t)}return i}function Ea(t){if(t._terminated)throw new M(L.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Ta(t),t._firestoreClient}function Ta(t){var e,n,r;const i=t._freezeSettings(),s=function(t,e,n,r){return new De(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,sa(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new Zo(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(t){const e=null==t?void 0:t._online.build();return{_offline:null==t?void 0:t._offline.build(e),_online:e}}(t._componentsProvider))}class _a{constructor(t){this._byteString=t}static fromBase64String(t){try{return new _a(me.fromBase64String(t))}catch(t){throw new M(L.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new _a(me.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:_a._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(dt(t,_a._jsonSchema))return _a.fromBase64String(t.bytes)}}_a._jsonSchemaVersion="firestore/bytes/1.0",_a._jsonSchema={type:ht("string",_a._jsonSchemaVersion),bytes:ht("string")};class Ca{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(let r=0;r<e.length;++r)if(0===e[r].length)throw new M(L.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new it(e)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Sa{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new M(L.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new M(L.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return X(this._lat,t._lat)||X(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Sa._jsonSchemaVersion}}static fromJSON(t){if(dt(t,Sa._jsonSchema))return new Sa(t.latitude,t.longitude)}}Sa._jsonSchemaVersion="firestore/geoPoint/1.0",Sa._jsonSchema={type:ht("string",Sa._jsonSchemaVersion),latitude:ht("number"),longitude:ht("number")};class Aa{constructor(t){this._values=(t||[]).map(t=>t)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}(this._values,t._values)}toJSON(){return{type:Aa._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(dt(t,Aa._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every(t=>"number"==typeof t))return new Aa(t.vectorValues);throw new M(L.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Aa._jsonSchemaVersion="firestore/vectorValue/1.0",Aa._jsonSchema={type:ht("string",Aa._jsonSchemaVersion),vectorValues:ht("object")};const Ia=new RegExp("[~\\*/\\[\\]]");function Da(t,e,n){if(e.search(Ia)>=0)throw ka("Invalid field path (".concat(e,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,n);try{return new Ca(...e.split("."))._internalPath}catch(r){throw ka("Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,n)}}function ka(t,e,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a="Function ".concat(e,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=" in field ".concat(r)),o&&(c+=" in document ".concat(i)),c+=")"),new M(L.INVALID_ARGUMENT,a+t+c)}class Na{constructor(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new da(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new xa(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Ra("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class xa extends Na{data(){return super.data()}}function Ra(t,e){return"string"==typeof e?Da(t,e):e instanceof Ca?e._internalPath:e._delegate._internalPath}function Oa(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new M(L.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Pa{convertValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Me(t)){case 0:return null;case 1:return t.booleanValue;case 2:return we(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(be(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw x(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return ae(t,(t,r)=>{n[t]=this.convertValue(r,e)}),n}convertVectorValue(t){var e,n,r;const i=null===(r=null===(n=null===(e=t.fields)||void 0===e?void 0:e[Le].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(t=>we(t.doubleValue));return new Aa(i)}convertGeoPoint(t){return new Sa(we(t.latitude),we(t.longitude))}convertArray(t,e){return(t.values||[]).map(t=>this.convertValue(t,e))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Ae(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Ie(t));default:return null}}convertTimestamp(t){const e=ve(t);return new gt(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=nt.fromString(t);O(Ci(n),9688,{name:t});const r=new Ne(n.get(1),n.get(3)),i=new st(n.popFirst(5));return r.isEqual(e)||D("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(e.projectId,"/").concat(e.database,") instead.")),i}}class La{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class Ma extends Na{constructor(t,e,n,r,i,s){super(t,e,n,r,s),this._firestore=t,this._firestoreImpl=t,this.metadata=i}exists(){return super.exists()}data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const e=new Fa(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Ra("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new M(L.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=Ma._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),t&&t.isValidDocument()&&t.isFoundDocument()?(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e):e}}Ma._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ma._jsonSchema={type:ht("string",Ma._jsonSchemaVersion),bundleSource:ht("string","DocumentSnapshot"),bundleName:ht("string"),bundle:ht("string")};class Fa extends Ma{data(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(t)}}class Va{constructor(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new La(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach(n=>{t.call(e,new Fa(this._firestore,this._userDataWriter,n.key,n,new La(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const t=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(L.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map(n=>{const r=new Fa(t._firestore,t._userDataWriter,n.doc.key,n.doc,new La(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:e++}})}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter(t=>e||3!==t.type).map(e=>{const r=new Fa(t._firestore,t._userDataWriter,e.doc.key,e.doc,new La(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let i=-1,s=-1;return 0!==e.type&&(i=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:Ua(e.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new M(L.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=Va._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Q.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],n=[],r=[];return this.docs.forEach(t=>{null!==t._document&&(e.push(t._document),n.push(this._userDataWriter.convertObjectMap(t._document.data.value.mapValue.fields,"previous")),r.push(t.ref.path))}),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function Ua(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return x(61501,{type:t})}}Va._jsonSchemaVersion="firestore/querySnapshot/1.0",Va._jsonSchema={type:ht("string",Va._jsonSchemaVersion),bundleSource:ht("string","QuerySnapshot"),bundleName:ht("string"),bundle:ht("string")};class ja extends Pa{constructor(t){super(),this.firestore=t}convertBytes(t){return new _a(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new da(this.firestore,null,e)}}function Ba(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var i,s,o;t=(0,c.Ku)(t);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||va(n[l])||(a=n[l++]);const u={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(va(n[l])){const t=n[l];n[l]=null===(i=t.next)||void 0===i?void 0:i.bind(t),n[l+1]=null===(s=t.error)||void 0===s?void 0:s.bind(t),n[l+2]=null===(o=t.complete)||void 0===o?void 0:o.bind(t)}let h,d,f;if(t instanceof da)d=ut(t.firestore,wa),f=xn(t._key.path),h={next:e=>{n[l]&&n[l](qa(d,t,e))},error:n[l+1],complete:n[l+2]};else{const e=ut(t,ha);d=ut(e.firestore,wa),f=e._query;const r=new ja(d);h={next:t=>{n[l]&&n[l](new Va(d,r,e,t))},error:n[l+1],complete:n[l+2]},Oa(t._query)}return function(t,e,n,r){const i=new Yo(r),s=new To(e,i,n);return t.asyncQueue.enqueueAndForget(async()=>go(await ia(t),s)),()=>{i.Ou(),t.asyncQueue.enqueueAndForget(async()=>mo(await ia(t),s))}}(Ea(d),f,u,h)}function qa(t,e,n){const r=n.docs.get(e._key),i=new ja(t);return new Ma(t,i,e._key,r,new La(n.hasPendingWrites,n.fromCache),e.converter)}new WeakMap;!function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(t){C=t}(s.MF),(0,s.om)(new o.uA("firestore",(t,n)=>{let{instanceIdentifier:r,options:i}=n;const s=t.getProvider("app").getImmediate(),o=new wa(new B(t.getProvider("auth-internal")),new H(s,t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new M(L.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ne(t.options.projectId,e)}(s,r),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),(0,s.KO)(E,T,t),(0,s.KO)(E,T,"esm2017")}()},6607:(t,e,n)=>{n.d(e,{A:()=>q});var r=n(45),i=n(9379),s=n(5043),o=n(8387),a=n(8610),c=n(2987),l=n(6803),u=n(1475),h=n(4535),d=n(5420),f=n(5213),p=n(4563),g=n(2532),m=n(2372);function y(t){return(0,m.Ay)("PrivateSwitchBase",t)}(0,g.A)("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);var v=n(4162),w=n(579);const b=["autoFocus","checked","checkedIcon","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value","slots","slotProps"],E=(0,h.Ay)(p.A)({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:t=>{let{edge:e,ownerState:n}=t;return"start"===e&&"small"!==n.size},style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:t=>{let{edge:e,ownerState:n}=t;return"end"===e&&"small"!==n.size},style:{marginRight:-12}}]}),T=(0,h.Ay)("input",{shouldForwardProp:u.A})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),_=s.forwardRef(function(t,e){const{autoFocus:n,checked:s,checkedIcon:o,defaultChecked:c,disabled:u,disableFocusRipple:h=!1,edge:p=!1,icon:g,id:m,inputProps:_,inputRef:C,name:S,onBlur:A,onChange:I,onFocus:D,readOnly:k,required:N=!1,tabIndex:x,type:R,value:O,slots:P={},slotProps:L={}}=t,M=(0,r.A)(t,b),[F,V]=(0,d.A)({controlled:s,default:Boolean(c),name:"SwitchBase",state:"checked"}),U=(0,f.A)();let j=u;U&&"undefined"===typeof j&&(j=U.disabled);const B="checkbox"===R||"radio"===R,q=(0,i.A)((0,i.A)({},t),{},{checked:F,disabled:j,disableFocusRipple:h,edge:p}),z=(t=>{const{classes:e,checked:n,disabled:r,edge:i}=t,s={root:["root",n&&"checked",r&&"disabled",i&&"edge".concat((0,l.A)(i))],input:["input"]};return(0,a.A)(s,y,e)})(q),K={slots:P,slotProps:(0,i.A)({input:_},L)},[H,G]=(0,v.A)("root",{ref:e,elementType:E,className:z.root,shouldForwardComponentProp:!0,externalForwardedProps:(0,i.A)((0,i.A)({},K),{},{component:"span"},M),getSlotProps:t=>(0,i.A)((0,i.A)({},t),{},{onFocus:e=>{var n;null===(n=t.onFocus)||void 0===n||n.call(t,e),(t=>{D&&D(t),U&&U.onFocus&&U.onFocus(t)})(e)},onBlur:e=>{var n;null===(n=t.onBlur)||void 0===n||n.call(t,e),(t=>{A&&A(t),U&&U.onBlur&&U.onBlur(t)})(e)}}),ownerState:q,additionalProps:{centerRipple:!0,focusRipple:!h,disabled:j,role:void 0,tabIndex:null}}),[W,Q]=(0,v.A)("input",{ref:C,elementType:T,className:z.input,externalForwardedProps:K,getSlotProps:t=>({onChange:e=>{var n;null===(n=t.onChange)||void 0===n||n.call(t,e),(t=>{if(t.nativeEvent.defaultPrevented)return;const e=t.target.checked;V(e),I&&I(t,e)})(e)}}),ownerState:q,additionalProps:(0,i.A)({autoFocus:n,checked:s,defaultChecked:c,disabled:j,id:B?m:void 0,name:S,readOnly:k,required:N,tabIndex:x,type:R},"checkbox"===R&&void 0===O?{}:{value:O})});return(0,w.jsxs)(H,(0,i.A)((0,i.A)({},G),{},{children:[(0,w.jsx)(W,(0,i.A)({},Q)),F?o:g]}))});var C=n(9662);const S=(0,C.A)((0,w.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),A=(0,C.A)((0,w.jsx)("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked");var I=n(2094);const D=(0,h.Ay)("span",{shouldForwardProp:u.A})({position:"relative",display:"flex"}),k=(0,h.Ay)(S)({transform:"scale(1)"}),N=(0,h.Ay)(A)((0,I.A)(t=>{let{theme:e}=t;return{left:0,position:"absolute",transform:"scale(0)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeIn,duration:e.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.shortest})}}]}}));const x=function(t){const{checked:e=!1,classes:n={},fontSize:r}=t,s=(0,i.A)((0,i.A)({},t),{},{checked:e});return(0,w.jsxs)(D,{className:n.root,ownerState:s,children:[(0,w.jsx)(k,{fontSize:r,className:n.background,ownerState:s}),(0,w.jsx)(N,{fontSize:r,className:n.dot,ownerState:s})]})};const R=n(2456).A;var O=n(2487);function P(t){return(0,m.Ay)("MuiRadio",t)}const L=(0,g.A)("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]);var M=n(2445),F=n(8206);const V=["checked","checkedIcon","color","icon","name","onChange","size","className","disabled","disableRipple","slots","slotProps","inputProps"],U=(0,h.Ay)(_,{shouldForwardProp:t=>(0,u.A)(t)||"classes"===t,name:"MuiRadio",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,"medium"!==n.size&&e["size".concat((0,l.A)(n.size))],e["color".concat((0,l.A)(n.color))]]}})((0,I.A)(t=>{let{theme:e}=t;return{color:(e.vars||e).palette.text.secondary,["&.".concat(L.disabled)]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:e.vars?"rgba(".concat(e.vars.palette.action.activeChannel," / ").concat(e.vars.palette.action.hoverOpacity,")"):(0,c.X4)(e.palette.action.active,e.palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter((0,M.A)()).map(t=>{let[n]=t;return{props:{color:n,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:e.vars?"rgba(".concat(e.vars.palette[n].mainChannel," / ").concat(e.vars.palette.action.hoverOpacity,")"):(0,c.X4)(e.palette[n].main,e.palette.action.hoverOpacity)}}}}),...Object.entries(e.palette).filter((0,M.A)()).map(t=>{let[n]=t;return{props:{color:n,disabled:!1},style:{["&.".concat(L.checked)]:{color:(e.vars||e).palette[n].main}}}}),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]}}));const j=(0,w.jsx)(x,{checked:!0}),B=(0,w.jsx)(x,{}),q=s.forwardRef(function(t,e){var n,c,u;const h=(0,F.b)({props:t,name:"MuiRadio"}),{checked:d,checkedIcon:p=j,color:g="primary",icon:m=B,name:y,onChange:b,size:E="medium",className:T,disabled:_,disableRipple:C=!1,slots:S={},slotProps:A={},inputProps:I}=h,D=(0,r.A)(h,V),k=(0,f.A)();let N=_;k&&"undefined"===typeof N&&(N=k.disabled),null!==N&&void 0!==N||(N=!1);const x=(0,i.A)((0,i.A)({},h),{},{disabled:N,disableRipple:C,color:g,size:E}),L=(t=>{const{classes:e,color:n,size:r}=t,s={root:["root","color".concat((0,l.A)(n)),"medium"!==r&&"size".concat((0,l.A)(r))]};return(0,i.A)((0,i.A)({},e),(0,a.A)(s,P,e))})(x),M=s.useContext(O.A);let q=d;const z=R(b,M&&M.onChange);let K=y;var H,G;M&&("undefined"===typeof q&&(H=M.value,q="object"===typeof(G=h.value)&&null!==G?H===G:String(H)===String(G)),"undefined"===typeof K&&(K=M.name));const W=null!==(n=A.input)&&void 0!==n?n:I,[Q,X]=(0,v.A)("root",{ref:e,elementType:U,className:(0,o.A)(L.root,T),shouldForwardComponentProp:!0,externalForwardedProps:(0,i.A)({slots:S,slotProps:A},D),getSlotProps:t=>(0,i.A)((0,i.A)({},t),{},{onChange:function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];null===(n=t.onChange)||void 0===n||n.call(t,e,...i),z(e,...i)}}),ownerState:x,additionalProps:{type:"radio",icon:s.cloneElement(m,{fontSize:null!==(c=m.props.fontSize)&&void 0!==c?c:E}),checkedIcon:s.cloneElement(p,{fontSize:null!==(u=p.props.fontSize)&&void 0!==u?u:E}),disabled:N,name:K,checked:q,slots:S,slotProps:{input:"function"===typeof W?W(x):W}}});return(0,w.jsx)(Q,(0,i.A)((0,i.A)({},X),{},{classes:L}))})},7064:(t,e,n)=>{n.d(e,{Wp:()=>r.Wp});var r=n(52);(0,r.KO)("firebase","11.10.0","app")},7972:(t,e,n)=>{n.d(e,{A:()=>S});var r=n(9379),i=n(45),s=n(5043),o=n(8387),a=n(8610),c=n(4535),l=n(8206),u=n(2532),h=n(2372);function d(t){return(0,h.Ay)("MuiFormGroup",t)}(0,u.A)("MuiFormGroup",["root","row","error"]);var f=n(5213),p=n(4827),g=n(579);const m=["className","row"],y=(0,c.Ay)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.row&&e.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),v=s.forwardRef(function(t,e){const n=(0,l.b)({props:t,name:"MuiFormGroup"}),{className:s,row:c=!1}=n,u=(0,i.A)(n,m),h=(0,f.A)(),v=(0,p.A)({props:n,muiFormControl:h,states:["error"]}),w=(0,r.A)((0,r.A)({},n),{},{row:c,error:v.error}),b=(t=>{const{classes:e,row:n,error:r}=t,i={root:["root",n&&"row",r&&"error"]};return(0,a.A)(i,d,e)})(w);return(0,g.jsx)(y,(0,r.A)({className:(0,o.A)(b.root,s),ownerState:w,ref:e},u))});function w(t){return(0,h.Ay)("MuiRadioGroup",t)}(0,u.A)("MuiRadioGroup",["root","row","error"]);var b=n(5849),E=n(5420),T=n(2487),_=n(5879);const C=["actions","children","className","defaultValue","name","onChange","value"],S=s.forwardRef(function(t,e){const{actions:n,children:c,className:l,defaultValue:u,name:h,onChange:d,value:f}=t,p=(0,i.A)(t,C),m=s.useRef(null),y=(t=>{const{classes:e,row:n,error:r}=t,i={root:["root",n&&"row",r&&"error"]};return(0,a.A)(i,w,e)})(t),[S,A]=(0,E.A)({controlled:f,default:u,name:"RadioGroup"});s.useImperativeHandle(n,()=>({focus:()=>{let t=m.current.querySelector("input:not(:disabled):checked");t||(t=m.current.querySelector("input:not(:disabled)")),t&&t.focus()}}),[]);const I=(0,b.A)(e,m),D=(0,_.A)(h),k=s.useMemo(()=>({name:D,onChange(t){A(t.target.value),d&&d(t,t.target.value)},value:S}),[D,d,A,S]);return(0,g.jsx)(T.A.Provider,{value:k,children:(0,g.jsx)(v,(0,r.A)((0,r.A)({role:"radiogroup",ref:I,className:(0,o.A)(y.root,l)},p),{},{children:c}))})})},8812:(t,e,n)=>{n.d(e,{h1:()=>a,uA:()=>i});var r=n(1529);class i{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const s="[DEFAULT]";class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new r.cY;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(n){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),r=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:s})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:r});n.resolve(t)}catch(e){}}}}clearInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instances.has(t)}getOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instancesOptions.get(t)||{}}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(r){}}getOrInitializeService(t){let{instanceIdentifier:e,options:n={}}=t,r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===s?void 0:i),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(o){}var i;return r||null}normalizeInstanceIdentifier(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.component?this.component.multipleInstances?t:s:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component ".concat(t.name," has already been registered with ").concat(this.name));e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}}}]);
//# sourceMappingURL=560.b71cc498.chunk.js.map